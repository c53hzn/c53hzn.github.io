<!doctype html>
<html data-n-head-ssr>
  <head>
    <title>Write a control panel for my API-based CMS for Nuxt | Jenny的小站</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="April CMS, a CMS that operates text files and serves with both interface and API, built for serving blog contents, come and check it out~"><meta data-n-head="ssr" data-hid="keyword" name="keyword" content="English, JavaScript, Node.js, jQuery, My Project, Tech"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/img/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="/css/font-gugi.css"><link data-n-head="ssr" rel="stylesheet" href="/css/font-poppins.css"><link data-n-head="ssr" rel="stylesheet" href="/css/style.css?2020-04-12"><link data-n-head="ssr" rel="stylesheet" href="/font-awesome/css/font-awesome.min.css"><link data-n-head="ssr" rel="stylesheet" href="/css/github-markdown.min.css"><link data-n-head="ssr" rel="stylesheet" href="/css/hljs.dark.min.css"><link data-n-head="ssr" rel="stylesheet" href="https://hzn-website.000webhostapp.com/disqus/dist/iDisqus.min.css"><script data-n-head="ssr" src="/js/statcounter.js"></script><base href="/"><link rel="preload" href="/_nuxt/a473fe36ef481c01f030.js" as="script"><link rel="preload" href="/_nuxt/275bef93b4559841d52d.js" as="script"><link rel="preload" href="/_nuxt/54e959968381881adf64.js" as="script"><link rel="preload" href="/_nuxt/ae4116cfdfc058b526d5.js" as="script"><style data-vue-ssr-id="3191d5ad:0 72520070:0 f28bdea2:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#3b8070;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.markdown-body{margin-bottom:50px}.markdown-body img{max-height:100px}a[id]{position:relative;top:-40px;display:block}a#comment-link{top:0}.blog-desc{margin:10px;padding:10px;color:#666;background-color:rgba(0,0,0,.025)}.youtube-img{position:relative;display:inline-block}.youtube-img:before{width:40%;height:40%;border-radius:25%;background:rgba(0,0,0,.7);transition:background .2s}.youtube-img:after,.youtube-img:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;margin:auto}.youtube-img:after{width:0;height:0;border-top:10px solid transparent;border-left:20px solid #fff;border-bottom:10px solid transparent}.youtube-img:hover:before{background:red}#disqus_thread{margin-top:20px}.prev-next{margin:20px auto;display:block}.prev-next:after{display:table;content:" ";clear:both}.prev-next a{display:inline}.next,.prev{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:20px auto;width:100%;color:grey;border:1px solid grey;cursor:pointer}.prev{width:48%;text-align:left;float:left}.next{width:48%;text-align:right;float:right}.next:hover,.prev:hover{color:#000;border-color:#000}.prev p{padding-left:16px}.next p,.prev p{margin:0;padding-top:16px;padding-bottom:16px}.next p{padding-right:16px}#comment{margin-top:40px}.blog-gallery{margin:20px auto;display:flex;justify-content:center;flex-wrap:wrap;overflow:hidden}.blog-gallery-unit{margin:40px 20px 0;width:46%;border:1px solid silver;border-radius:5px}.blog-gallery-unit:first-child,.blog-gallery-unit:nth-child(2){margin-top:20px}.blog-gallery-unit:nth-child(2n-1){margin-left:0}.blog-gallery-unit:nth-child(2n){margin-right:0}.blog-gallery-unit:hover{border-color:#000}.blog-gallery-inner{padding:21px 10px 10px;height:100%}.blog-gallery-inner h4{margin-top:0;max-height:42px;overflow:hidden}.blog-gallery-desc{line-height:21px;max-height:64px;display:block;overflow:hidden}.blog-gallery-tag{margin:1px;padding:0 8px;color:#fff;font-size:12px;font-family:Microsoft Yahei;line-height:20px;border-radius:999px;background:grey;display:inline-block}@media (max-width:425px){.blog-gallery-unit{margin:20px 0 0;width:100%}}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="container"><nav><div class="nav-wrap"><header><a href="/" class="no-decor-link"><p class="nav-home">Jenny's blog</p></a></header> <div class="nav-btn"><div class="bar"></div> <div class="bar"></div> <div class="bar"></div> <div class="bar"></div></div> <div class="nav-mask"></div> <div class="body-mask"></div> <ul class="nav-ul"><a href="/" target="_self" class="nav-link"><li>首页<!----><!----></li></a><a href="/resume" target="_self" class="nav-link"><li>简历<!----><!----></li></a><a href="/portfolio" target="_self" class="nav-link"><li>作品集<!----><!----></li></a><a href="/blog" target="_self" class="nav-link nuxt-link-active"><li>博客<!----><!----></li></a><a href="https://wj.qq.com/s2/3731207/f0cd/" target="_blank" class="nav-link"><li>联系我<span> </span><i class="fa fa-external-link"></i></li></a></ul></div></nav> <main><div><section class="main-content"><h1 class="align-center">Write a control panel for my API-based CMS for Nuxt</h1> <p class="blog-date align-center"><span class="fa fa-calendar"> 2020-04-26</span></p> <p class="blog-tags align-center"><a href="/blog/tag/English"><span class="blog-tag">English</span></a><a href="/blog/tag/JavaScript"><span class="blog-tag">JavaScript</span></a><a href="/blog/tag/Node.js"><span class="blog-tag">Node.js</span></a><a href="/blog/tag/jQuery"><span class="blog-tag">jQuery</span></a><a href="/blog/tag/My Project"><span class="blog-tag">My Project</span></a><a href="/blog/tag/Tech"><span class="blog-tag">Tech</span></a></p> <div class="blog-desc">April CMS, a CMS that operates text files and serves with both interface and API, built for serving blog contents, come and check it out~</div> <article class="markdown-body"><p></p><h3> </h3><ul><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#A_true_CMS_1">A true CMS</a></li><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#What_I_need_for_backend_23">What I need for backend</a></li><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#What_I_need_for_frontend_32">What I need for front-end</a></li><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#Actual_codes_for_backend_53">Actual codes for backend</a></li><ul><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#Dependencies_for_API_55">Dependencies for API</a></li><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#To_return_unrendered_Markdown_when_called_103">To return unrendered Markdown when called</a></li><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#Add_Backend_UI_for_API_238">Add Backend UI for API</a></li><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#To_save_and_delete_file_265">To save and delete file</a></li></ul><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#Actual_codes_for_frontend_300">Actual codes for front-end</a></li><ul><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#To_call_API_and_Markdown_302">To call API and Markdown</a></li><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#Points_to_notice_when_rendering_Markdown_309">Points to notice when rendering Markdown</a></li><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#Add_smooth_scrolling_effect_353">Add smooth scrolling effect</a></li></ul><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#Here_is_what_it_looks_like_381">Here is what it looks like</a></li><li><a href="blog/editor-for-my-cms-of-my-nuxt-blog-en#Experience_from_this_393">Experience from this</a></li></ul><p></p>
<h1><a id="A_true_CMS_1"></a>A true CMS</h1>
<p>This is a translation of original article <a href="/blog/editor-for-my-cms-of-my-nuxt-blog">给Nuxt使用的基于API的CMS——还有管理后台呢</a>.</p>
<p>Github repo: <a href="https://github.com/c53hzn/april-cms">https://github.com/c53hzn/april-cms</a></p>
<p>Last year when I started to learn <code>Nuxt</code>, I read a lot about <code>Headless CMS</code>, it can be called a <code>CMS without front-end page design</code> according to my understanding. I studied some of these projects and methods to use them, and tried to use one myself, but did not make it to the end. I still wanted to build up my website without relying on these external services. Although for comment system and visitor counter I might still be using external services as long as I'm building static website.</p>
<p>Then I managed to write an <code>API</code> to serve as a <code>CMS</code>, you can refer to <a href="blog/nuxt-blog-static-website-en">this article</a>.</p>
<p>This <code>API</code> allows me to update my <code>Markdown</code> articles and use <code>Nuxt</code> to generate static page files, then I can push them to Github and update my website.</p>
<p>Usually I use <code>Sublime Text</code> to write codes, this editor can show working documents on the left, and it is easy to switch between files.</p>
<blockquote>
<p>But humans tend to go on a hard way.</p>
<p>by Me</p>
</blockquote>
<p>I want a <code>CMS</code> with an interface, and I can create/ modify/ read/ save/ delete in that interface. Also I  don't want a database, I just want to work on the <code>Markdown</code> files.</p>
<p>I think I can do it.</p>
<h1><a id="What_I_need_for_backend_23"></a>What I need for backend</h1>
<p>I wrote my <code>API</code> with <code>express</code> framework under <code>Node</code> environment, and I still want to achieve more with the same structure, so there are a few methods that I need to master, like:</p>
<ol>
<li>Make the <code>API</code> to read static HTML page and return a <code>CMS</code> UI on the browser.</li>
<li>When the <code>API</code> is started, the browser will automatically be opened and go to the <code>CMS</code> control panel.</li>
<li>Make the <code>API</code> to receive data sent from browser(clients) and save on local computer.</li>
<li>Make the <code>API</code> to receive data sent from browser and delete related file.</li>
</ol>
<h1><a id="What_I_need_for_frontend_32"></a>What I need for front-end</h1>
<p>I had a <a href="https://www.codepen.io">CodePen</a> project <a href="https://codepen.io/c53hzn/full/YzzRzxR">Markdown Previewer</a> that only has fewer than 5 visits in the last half year. It would be a shame to leave it there, and it might be better if I can use it here.</p>
<p>The CodePen project was rendered with <code>marked</code>, while my API was rendered with <code>markdown-it</code>. In order to consolidate my codes, I decided to change the renderer to <code>markdown-it</code>.</p>
<p>The project was written with <code>jQuery</code>, I decided to continue using <code>jQuery</code> for the front-end page interaction after some comparison.</p>
<p>Here are some issues that we need to solve:</p>
<ol>
<li>To read article list from <code>API</code> and render it in article list ares.</li>
<li>To read article contents from <code>API</code> and fill in title/ tags/ description/ related blogs/ main contents to relevant input box or textarea, and then the preview area</li>
<li>Every time there is a change in the <code>Markdown</code> editor, the preview area should be updated simultaneously, it also should have code highlight and normal HTML styles.</li>
<li>When <code>Save post</code> is clicked, the page should confirm is all input boxed are filled, if <code>No</code> then page will <code>alert</code> that user should fill in all blanks. If <code>Yes</code> then check if article already exists, if <code>Yes</code> then <code>confirm</code> if need to update post, if <code>No</code> then <code>confirm</code> if need to create new post.</li>
<li>When <code>Delete post</code> is clicked, the page should crosscheck if <code>slug</code> exists in post list, if <code>No</code> then <code>alert</code> that there is nothing to delete, if <code>Yes</code> then <code>confirm</code> if really need to delete.。</li>
<li>When <code>Ctrl+enter</code> is pressed on keyboard, <code>save</code> action should be triggered.</li>
<li>When creating or updating, the browser will use <code>post</code> method in <code>jQuery</code> to submit contents to server and receive result and reflect it to browser.</li>
<li>When deleting, the browser will use use <code>post</code> method in <code>jQuery</code> to submit the <code>slug</code> of the post to server, then receive result of deletion and reflect it to browser.</li>
</ol>
<p>All actions should be completed in the same page.</p>
<h1><a id="Actual_codes_for_backend_53"></a>Actual codes for backend</h1>
<h2><a id="Dependencies_for_API_55"></a>Dependencies for API</h2>
<p>First <code>require</code> all the dependencies and other required modules.</p>
<pre class="hljs"><code class="language-javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">"express"</span>);
<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">var</span> fm = <span class="hljs-built_in">require</span>(<span class="hljs-string">'front-matter'</span>);
<span class="hljs-keyword">var</span> hljs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'highlight.js'</span>);
<span class="hljs-keyword">var</span> yaml = <span class="hljs-built_in">require</span>(<span class="hljs-string">"yaml"</span>);
<span class="hljs-keyword">var</span> markdownIt = <span class="hljs-built_in">require</span>(<span class="hljs-string">'markdown-it'</span>);
<span class="hljs-keyword">var</span> markdownItToc = <span class="hljs-built_in">require</span>(<span class="hljs-string">'markdown-it-toc'</span>);
<span class="hljs-keyword">var</span> open = <span class="hljs-built_in">require</span>(<span class="hljs-string">"open"</span>);
<span class="hljs-keyword">var</span> config = <span class="hljs-built_in">require</span>(__dirname+<span class="hljs-string">"\\config.js"</span>);

<span class="hljs-keyword">var</span> app = express();
<span class="hljs-keyword">var</span> md = markdownIt({
  <span class="hljs-attr">html</span>:         <span class="hljs-literal">false</span>,        <span class="hljs-comment">// 在源码中启用 HTML 标签</span>
  xhtmlOut:     <span class="hljs-literal">false</span>,        <span class="hljs-comment">// 使用 '/' 来闭合单标签 （比如 &lt;br />）。</span>
  breaks:       <span class="hljs-literal">false</span>,        <span class="hljs-comment">// 转换段落里的 '\n' 到 &lt;br>。</span>
  langPrefix:   <span class="hljs-string">'language-'</span>,  <span class="hljs-comment">// 给围栏代码块的 CSS 语言前缀。对于额外的高亮代码非常有用。</span>
  linkify:      <span class="hljs-literal">false</span>,        <span class="hljs-comment">// 将类似 URL 的文本自动转换为链接。</span>
  typographer:  <span class="hljs-literal">false</span>,
  <span class="hljs-attr">quotes</span>: <span class="hljs-string">'“”‘’'</span>,
  <span class="hljs-attr">highlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, lang</span>) </span>{
    <span class="hljs-keyword">if</span> (lang && hljs.getLanguage(lang)) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> hljs.highlight(lang, str).value;
      } <span class="hljs-keyword">catch</span> (__) {}
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>; <span class="hljs-comment">// 使用额外的默认转义</span>
  }
});
md.use(markdownItToc);
</code></pre>
<p>The <code>config</code> here is an extra configuration file that I added, the contents inside it is simple:</p>
<pre class="hljs"><code class="language-javascript"><span class="hljs-keyword">var</span> config = {
	<span class="hljs-attr">isSlugUseDate</span>: <span class="hljs-literal">false</span>,
	<span class="hljs-attr">blogPath</span>: __dirname + <span class="hljs-string">'\\blog'</span>,
	<span class="hljs-attr">imgPath</span>: __dirname + <span class="hljs-string">'\\img\\blog'</span>
};
<span class="hljs-built_in">module</span>.exports = config;
</code></pre>
<p>This <code>config</code> is to control the <code>Markdown</code> file path and image file path, and also whether to use date when it comes to <code>slug</code>. If <code>slug</code> uses date, then it will be a long <code>slug</code>, like <code>2020-04-26-editor-for-my-cms-of-my-nuxt-blog-en</code>. If <code>slug</code> does not use date, then it will be a short <code>slug</code>, like <code>editor-for-my-cms-of-my-nuxt-blog-en</code>, and the real blog <code>URL</code> will also be changed with it.</p>
<h2><a id="To_return_unrendered_Markdown_when_called_103"></a>To return unrendered Markdown when called</h2>
<p>First do some settings in the <code>API</code> entry point file <code>app.js</code>, this is to control whether to return <code>Markdown</code> or rendered <code>HTML</code> contents, and <code>API</code> will also return contents according to <code>slug</code> in request based on configuration.</p>
<pre class="hljs"><code class="language-JavaScript"><span class="hljs-keyword">var</span> slugToFileName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">slug,isSlugUseDate</span>) </span>{
  <span class="hljs-keyword">var</span> result = <span class="hljs-string">""</span>;
  <span class="hljs-keyword">if</span> (isSlugUseDate) {
    result = slug+<span class="hljs-string">".md"</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">var</span> files = fs.readdirSync(config.blogPath);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {
      <span class="hljs-keyword">let</span> tempSlug = files[i].substring(<span class="hljs-number">11</span>,files[i].length);
      <span class="hljs-keyword">if</span> (tempSlug == slug+<span class="hljs-string">".md"</span>) {
        result = files[i];
        <span class="hljs-keyword">break</span>;
      }
    }
  }
  <span class="hljs-keyword">return</span> result;
}
<span class="hljs-keyword">var</span> fileNameToSlug = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filename,isSlugUseDate</span>) </span>{
  <span class="hljs-keyword">if</span> (isSlugUseDate) {
    <span class="hljs-keyword">return</span> filename.substring(<span class="hljs-number">0</span>,filename.length<span class="hljs-number">-3</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> filename.substring(<span class="hljs-number">11</span>,filename.length<span class="hljs-number">-3</span>);
  }
}
<span class="hljs-keyword">var</span> singleBlog = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fullPath,slug,isContentRequired,isMD,isDev</span>) </span>{
  <span class="hljs-keyword">var</span> blog = {};
  <span class="hljs-keyword">var</span> content = fm(fs.readFileSync(fullPath, <span class="hljs-string">"utf8"</span>));
  blog = content.attributes;
  blog.slug = slug;
  <span class="hljs-keyword">var</span> fullFilename = fullPath.replace(config.blogPath+<span class="hljs-string">"\\"</span>,<span class="hljs-string">""</span>);
  blog.date = fullFilename.substring(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>);
  <span class="hljs-keyword">if</span> (isContentRequired && !isMD) {
    <span class="hljs-keyword">let</span> html = md.render(<span class="hljs-string">'@[toc]( )\n'</span> + content.body);
    <span class="hljs-comment">//if isDev then use absolute path for images</span>
    <span class="hljs-keyword">if</span> (isDev) {
      html = html.replace(<span class="hljs-regexp">/src=\"(\/)?img/g</span>,<span class="hljs-string">"src=\"http://127.0.0.1:4000/img"</span>);
    }
    <span class="hljs-comment">// add class "hljs" for dark theme rendering</span>
    blog.content = html.replace(<span class="hljs-regexp">/\&lt;pre/g</span>,<span class="hljs-string">"&lt;pre class='hljs'"</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isContentRequired && isMD) {
    blog.content = content.body;
  }
  <span class="hljs-keyword">return</span> blog;
}
<span class="hljs-comment">//return blog related contents</span>
app.get(<span class="hljs-string">"/blog"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-comment">// allow cross orign access</span>
  res.header(<span class="hljs-string">'Access-Control-Allow-Origin'</span>, <span class="hljs-string">'*'</span>);
  <span class="hljs-keyword">var</span> blogPath = config.blogPath;
  <span class="hljs-keyword">var</span> imgPath = config.imgPath;
  <span class="hljs-keyword">var</span> files = fs.readdirSync(blogPath);
  <span class="hljs-keyword">var</span> json = {};<span class="hljs-comment">// result to be returned</span>
  <span class="hljs-keyword">var</span> qSlug = req.query.slug || <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> qTag = req.query.tag || <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> qImg = req.query.img || <span class="hljs-string">""</span>;
  <span class="hljs-keyword">var</span> qIsMD = req.query.ismd == <span class="hljs-string">"true"</span>;
  <span class="hljs-keyword">var</span> qIsDev = req.query.isdev == <span class="hljs-string">"true"</span>;
  <span class="hljs-keyword">var</span> isSlugUseDate = (req.query.iseditor == <span class="hljs-string">"true"</span>)?<span class="hljs-literal">true</span>:config.isSlugUseDate;
  <span class="hljs-keyword">if</span> (qSlug) {<span class="hljs-comment">// with blog slug query</span>
    json = singleBlog(<span class="hljs-string">`<span class="hljs-subst">${blogPath}</span>\\<span class="hljs-subst">${slugToFileName(qSlug,isSlugUseDate)}</span>`</span>,qSlug,<span class="hljs-literal">true</span>,qIsMD,qIsDev);
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; files.length; k++) {<span class="hljs-comment">// add prev and next blog</span>
      <span class="hljs-keyword">if</span> (qSlug == fileNameToSlug(files[k],isSlugUseDate)) {
        <span class="hljs-keyword">if</span> (k === <span class="hljs-number">0</span>) {
          json.next = fileNameToSlug(files[k+<span class="hljs-number">1</span>],isSlugUseDate);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (k === files.length<span class="hljs-number">-1</span>) {
          json.prev = fileNameToSlug(files[k<span class="hljs-number">-1</span>],isSlugUseDate);
        } <span class="hljs-keyword">else</span> {
          json.prev = fileNameToSlug(files[k<span class="hljs-number">-1</span>],isSlugUseDate);
          json.next = fileNameToSlug(files[k+<span class="hljs-number">1</span>],isSlugUseDate);
        }
      }
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (qTag) {<span class="hljs-comment">// with tag query</span>
    <span class="hljs-keyword">if</span> (qTag == <span class="hljs-string">"all_tags"</span>) {<span class="hljs-comment">// returns list of all available tags</span>
      json.tags = {};
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {
        <span class="hljs-keyword">let</span> blogPost = singleBlog(blogPath+<span class="hljs-string">"\\"</span>+files[i],fileNameToSlug(files[i],isSlugUseDate));
        <span class="hljs-keyword">let</span> tags = blogPost.tags || [<span class="hljs-string">'none'</span>];
        <span class="hljs-keyword">let</span> entry = {
          <span class="hljs-attr">title</span>: blogPost.title,
          <span class="hljs-attr">slug</span>: blogPost.slug
        };
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; tags.length; j++) {
          <span class="hljs-keyword">if</span> (json.tags[tags[j]]) {
            json.tags[tags[j]]++;
          } <span class="hljs-keyword">else</span> {
            json.tags[tags[j]] = <span class="hljs-number">1</span>;
          }
        }
      }
    } <span class="hljs-keyword">else</span> {<span class="hljs-comment">// returns blog list of specific tag</span>
      json.blogs = [];
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {
        <span class="hljs-keyword">let</span> blogPost = singleBlog(blogPath+<span class="hljs-string">"\\"</span>+files[i],fileNameToSlug(files[i],isSlugUseDate));
        <span class="hljs-keyword">let</span> tags = blogPost.tags || [<span class="hljs-string">'none'</span>];
        <span class="hljs-keyword">let</span> entry = {
          <span class="hljs-attr">title</span>: blogPost.title,
          <span class="hljs-attr">slug</span>: blogPost.slug
        };
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; tags.length; j++) {
          <span class="hljs-keyword">if</span> (tags[j] == qTag) {
            json.blogs.unshift(blogPost);
          }
        }
      }
    }
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (qImg) {<span class="hljs-comment">// with img query</span>
    <span class="hljs-keyword">if</span> (qImg == <span class="hljs-string">"all_imgs"</span>) {
      json.imgs = {};
      <span class="hljs-keyword">var</span> imgFolders = fs.readdirSync(imgPath);
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; imgFolders.length; i++) {
        <span class="hljs-keyword">let</span> imgs = fs.readdirSync(imgPath+<span class="hljs-string">"\\"</span>+imgFolders[i]);
        json.imgs[imgFolders[i]] = imgs;
      }
    }
  } <span class="hljs-keyword">else</span> {<span class="hljs-comment">//without requirement, returns list of all blogs</span>
    json.blogs = [];
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {
      <span class="hljs-keyword">let</span> blogPost = singleBlog(blogPath+<span class="hljs-string">"\\"</span>+files[i],fileNameToSlug(files[i],isSlugUseDate));
      json.blogs.unshift(blogPost);
    }
  }
  res.send(json);
});
app.get(<span class="hljs-string">"/config"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{
  <span class="hljs-comment">// allow cross orign access</span>
  res.header(<span class="hljs-string">'Access-Control-Allow-Origin'</span>, <span class="hljs-string">'*'</span>);
  res.send(config);
});
</code></pre>
<h2><a id="Add_Backend_UI_for_API_238"></a>Add Backend UI for API</h2>
<p>The entry point for Backend UI is <code>app.html</code>, and in order to access the static page <code>app.html</code>, you need codes below:</p>
<pre class="hljs"><code>//return blog content editor page
app.use(express.static(__dirname));
app.get("/", function(req, res) {
    // allow cross orign access
  res.header('Access-Control-Allow-Origin', '*');
  res.sendFile(__dirname+"\\app.html");
});
/* nuxt is using port 3000, so choose another one */
app.listen(4000, () => {
  console.log("express server running at http://127.0.0.1:4000")
});
</code></pre>
<p>Then the entry link for the <code>CMS</code> should be <code>http://127.0.0.1:4000/</code>.</p>
<p>In order to start <code>API</code> and open browser to access this page, you will need an <code>npm</code> called <code>open</code>. Just write one line of command.</p>
<pre class="hljs"><code class="language-JavaScript">open(<span class="hljs-string">"http:127.0.0.1:4000/"</span>,{<span class="hljs-attr">app</span>: <span class="hljs-string">"chrome.exe"</span>});
</code></pre>
<p>This will open browser and go to <code>CMS</code> control panel. There is only one page for the control panel, so it's easy to manage.</p>
<h2><a id="To_save_and_delete_file_265"></a>To save and delete file</h2>
<p>Then there is the need for receiving data from browser and save it to local computer, or receiving data from browser and delete relevant file.</p>
<pre class="hljs"><code class="language-JavaScript"><span class="hljs-comment">//api to submit post</span>
<span class="hljs-comment">// Parse URL-encoded bodies (as sent by HTML forms)</span>
app.use(express.urlencoded({ <span class="hljs-attr">extended</span>: <span class="hljs-literal">true</span> }));
<span class="hljs-comment">// Parse JSON bodies (as sent by API clients)</span>
app.use(express.json());
<span class="hljs-comment">// Access the parse results as request.body</span>
app.post(<span class="hljs-string">'/savepost'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>)</span>{
  <span class="hljs-keyword">var</span> obj = req.body;
  <span class="hljs-keyword">var</span> fileName = config.blogPath+<span class="hljs-string">"\\"</span>+obj.slug+<span class="hljs-string">".md"</span>;
    fs.writeFileSync(fileName, obj.str);
    <span class="hljs-comment">//Client will get status of failure w/o this</span>
    <span class="hljs-comment">//even if data is saved to server successfully</span>
    res.send({<span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>});
});
<span class="hljs-comment">// delete post</span>
app.post(<span class="hljs-string">'/deletepost'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>)</span>{
  <span class="hljs-keyword">var</span> obj = req.body;
  <span class="hljs-keyword">var</span> fileName = config.blogPath+<span class="hljs-string">"\\"</span>+obj.slug+<span class="hljs-string">".md"</span>;
  <span class="hljs-keyword">try</span> {
    fs.unlinkSync(fileName);
    <span class="hljs-comment">//file removed</span>
  } <span class="hljs-keyword">catch</span>(err) {
    <span class="hljs-built_in">console</span>.error(err);
  }
    <span class="hljs-comment">//Client will get status of failure w/o this</span>
    <span class="hljs-comment">//even if data is saved to server successfully</span>
    res.send({<span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>});
});
</code></pre>
<h1><a id="Actual_codes_for_frontend_300"></a>Actual codes for front-end</h1>
<h2><a id="To_call_API_and_Markdown_302"></a>To call API and Markdown</h2>
<p>There is not much to say about the full codes. To get post list, you can call <code>/blogs</code> with <code>jQuery</code>'s <code>getJSON</code> method, and to save post you can call <code>/savepost</code>, and to delete post you can call <code>/deletepost</code>, both with <code>post</code> method in <code>jQuery</code>.</p>
<p>You can get <code>Markdown</code> contents from the editor in UI and use <code>markdown-it</code> to render to the preview area, also don't forget the <code>highlight.js</code> and <code>markdown-it-toc</code> plugins, then import <code>github-markdown</code>
and the <code>css</code> for <code>highlight.js</code> to render the converted <code>HTML</code>, it's almost done.</p>
<h2><a id="Points_to_notice_when_rendering_Markdown_309"></a>Points to notice when rendering Markdown</h2>
<p>Here you might want to take a look at the usage for those <code>Node</code> when applying them to browser.</p>
<p>When it was just <code>Node</code> script, first you <code>require</code> them.</p>
<pre class="hljs"><code class="language-JavaScript"><span class="hljs-keyword">var</span> markdownIt = <span class="hljs-built_in">require</span>(<span class="hljs-string">'markdown-it'</span>);
<span class="hljs-keyword">var</span> hljs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'highlight.js'</span>);
<span class="hljs-keyword">var</span> markdownItToc = <span class="hljs-built_in">require</span>(<span class="hljs-string">'markdown-it-toc'</span>);
</code></pre>
<p>Then you configure them.</p>
<pre class="hljs"><code class="language-JavaScript"><span class="hljs-keyword">var</span> md = markdownIt({
  <span class="hljs-attr">html</span>:         <span class="hljs-literal">false</span>,
  <span class="hljs-attr">xhtmlOut</span>:     <span class="hljs-literal">false</span>,
  <span class="hljs-attr">breaks</span>:       <span class="hljs-literal">false</span>,
  <span class="hljs-attr">langPrefix</span>:   <span class="hljs-string">'language-'</span>,
  <span class="hljs-attr">linkify</span>:      <span class="hljs-literal">false</span>,
  <span class="hljs-attr">typographer</span>:  <span class="hljs-literal">false</span>,
  <span class="hljs-attr">quotes</span>: <span class="hljs-string">'“”‘’'</span>,
  <span class="hljs-attr">highlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, lang</span>) </span>{
    <span class="hljs-keyword">if</span> (lang && hljs.getLanguage(lang)) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> hljs.highlight(lang, str).value;
      } <span class="hljs-keyword">catch</span> (__) {}
    }
    <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;
  }
});
md.use(markdownItToc);
</code></pre>
<p>Now you can use it to render <code>Markdown</code>.</p>
<p>But when I used the same settings for browser, there is always error saying this or that object is not found.</p>
<p>Then I discovered that the variables exposed by original authors have different casing comparing to my settings.</p>
<p>I opened those <code>.js</code> files and check the variables one by one and found that <code>markdown-it</code> used <code>markdownit</code> as global variable, and <code>markdown-it-toc</code>, the plugin that I used for generating anchor links, used <code>markdownitTOC</code> as global variable. After changing my settings, the script is finally OK to run</p>
<p>This should not have been a problem, I'm really upset about it.</p>
<h2><a id="Add_smooth_scrolling_effect_353"></a>Add smooth scrolling effect</h2>
<p>I added anchor links for preview area, and I want those <code>#</code> links will not direct the page to those internal links, but rather have the page scroll to relevant position smoothly, here are the codes:</p>
<pre class="hljs"><code class="language-JavaScript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updatePreview</span>(<span class="hljs-params"></span>)</span>{
  <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>;
  <span class="hljs-keyword">var</span> source = $(<span class="hljs-string">"#editor"</span>).val();
  <span class="hljs-keyword">var</span> html = <span class="hljs-string">"\t"</span> + md.render(<span class="hljs-string">'[toc]\n'</span> + source);
  html = html.replace(<span class="hljs-regexp">/\&lt;a/g</span>,<span class="hljs-string">"&lt;a target='_blank'"</span>);
  $(<span class="hljs-string">"#preview"</span>).html(html);
  <span class="hljs-comment">//add scrollIntoView to anchor link</span>
  <span class="hljs-keyword">var</span> aTags = d.querySelectorAll(<span class="hljs-string">"a[href]"</span>);
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; aTags.length; i++) {
    <span class="hljs-keyword">if</span> (aTags[i].href.indexOf(<span class="hljs-string">"#"</span>) !== <span class="hljs-number">-1</span>) {
      aTags[i].onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">var</span> c = e || event;
        c.preventDefault();
        <span class="hljs-keyword">var</span> href = aTags[i].href;
        <span class="hljs-keyword">var</span> hashPos = href.indexOf(<span class="hljs-string">"#"</span>);
        <span class="hljs-keyword">var</span> id = href.substring(hashPos+<span class="hljs-number">1</span>, href.length);
        d.querySelector(<span class="hljs-string">"a[id='"</span>+<span class="hljs-built_in">String</span>(id)+<span class="hljs-string">"']"</span>).scrollIntoView({<span class="hljs-attr">behavior</span>: <span class="hljs-string">"smooth"</span>});
      }
    }
  }
}
</code></pre>
<h1><a id="Here_is_what_it_looks_like_381"></a>Here is what it looks like</h1>
<p>When you need to access this <code>API</code>, you can <code>cd</code> to that folder and</p>
<pre class="hljs"><code>node index.js
</code></pre>
<p>Then browser will open itself and be directed to <code>http://127.0.0.1:4000/</code>, you will be able to see post list, and be able to create/delete/modify articles, see the capture below</p>
<p><img src="/img/blog/2020-04-19/001.png" alt="preview"></p>
<h1><a id="Experience_from_this_393"></a>Experience from this</h1>
<p>I finished what I started a year ago, and it only took me one day, I'm really happy about it.</p>
<p>If I am to give a name to this CMS, I think I will call it <code>April CMS</code>, because I finished it in April.</p>
<p>After finishing it, I did some study and think that, this <code>CMS</code> fits both descriptions of <code>API-based Headless CMS</code> and <code>Flat File CMS</code>, which is <code>a CMS that operates on text files rather than databases</code>. Seems good!</p>
<p>And the preview area and post list area will update themselves as you input and save or delete post, it will be really smooth when you write with it, maybe it can be used for writing documents or stories.</p>
<p>Don't know what more compliments can I say about it :)</p>
<p>On top of it, this <code>CMS</code> is a useful thing, and I hope I can create more useful stuff in the future.</p>
</article> <div class="prev-next"><a href="/blog/editor-for-my-cms-of-my-nuxt-blog" class="no-decor-link"><div class="prev"><p>上一篇</p></div></a> <a href="/blog/enable-spellcheck-on-chrome-en" class="no-decor-link"><div class="next"><p>下一篇</p></div></a></div> <div><h3 style="text-align:center"><span style="border-bottom:2px solid #000">相关文章</span></h3> <div class="blog-gallery"><div class="blog-gallery-unit"><a href="/blog/editor-for-my-cms-of-my-nuxt-blog" title="April CMS，一个兼具Headless CMS和Flat File CMS的特征的操作文本文件的基于API提供内容的CMS，很实用的一个项目哦~" class="no-decor-link"><div class="blog-gallery-inner align-left"><h4>给Nuxt使用的基于API的CMS——还有管理后台呢</h4> <p class="blog-date"><span class="fa fa-calendar">
               2020-04-19
            </span></p> <p class="align-left"><span class="blog-gallery-desc">April CMS，一个兼具Headless CMS和Flat File CMS的特征的操作文本文件的基于API提供内容的CMS，很实用的一个项目哦~</span> <br> <span class="align-left"><span class="blog-gallery-tag">
                我的项目
              </span><span class="blog-gallery-tag">
                JavaScript
              </span><span class="blog-gallery-tag">
                Node.js
              </span><span class="blog-gallery-tag">
                jQuery
              </span><span class="blog-gallery-tag">
                技术
              </span></span></p></div></a></div><div class="blog-gallery-unit"><a href="/blog/nuxt-blog-static-website-en" title="I built up my website with Nuxt. First I created an API to parse Markdown articles and return JSON contents, and then used Nuxt+Axios to call this API to retrieve blog article and generate static pages based on this structure. Here you can see some details." class="no-decor-link"><div class="blog-gallery-inner align-left"><h4>How to build up a static blog website with Nuxt</h4> <p class="blog-date"><span class="fa fa-calendar">
               2020-04-05
            </span></p> <p class="align-left"><span class="blog-gallery-desc">I built up my website with Nuxt. First I created an API to parse Markdown articles and return JSON contents, and then used Nuxt+Axios to call this API to retrieve blog article and generate static pages based on this structure. Here you can see some details.</span> <br> <span class="align-left"><span class="blog-gallery-tag">
                English
              </span><span class="blog-gallery-tag">
                JavaScript
              </span><span class="blog-gallery-tag">
                Nuxt
              </span><span class="blog-gallery-tag">
                Static Blog
              </span><span class="blog-gallery-tag">
                Tech
              </span></span></p></div></a></div></div></div> <div id="comment"></div></section></div></main> <footer><p>Created with Nuxt.js <br>
    	Made by  
    	<a href="https://github.com/c53hzn" target="_blank" class="no-decor-link"><strong>Jenny HOU</strong> <i class="fa fa-github font-20"></i></a></p> <div class="go-top go-top-hidden"><div class="arrow"></div> <div class="stick"></div></div></footer></div></div></div><script>window.__NUXT__=function(s,a,e,n,l,t,o,r,p,c,i,d){return i[0]=r,i[1]=a,i[2]=t,i[3]=n,i[4]="My Project",{layout:"page",data:[{relatedBlog:[{layout:e,title:"给Nuxt使用的基于API的CMS——还有管理后台呢",description:"April CMS，一个兼具Headless CMS和Flat File CMS的特征的操作文本文件的基于API提供内容的CMS，很实用的一个项目哦~",tags:["我的项目",a,t,n,"技术"],comments:!0,related_blog:["2020-01-31-summary-of-my-life-in-2019",l],slug:s,date:"2020-04-19",prev:"script-for-photoshop-bulk-resize-and-watermark-en",next:o},{layout:e,title:"How to build up a static blog website with Nuxt",description:"I built up my website with Nuxt. First I created an API to parse Markdown articles and return JSON contents, and then used Nuxt+Axios to call this API to retrieve blog article and generate static pages based on this structure. Here you can see some details.",tags:[r,a,"Nuxt","Static Blog",i[5]=p],comments:!0,related_blog:[l],slug:c,date:"2020-04-05",prev:"tv-drama-die-now",next:"script-for-photoshop-bulk-resize-and-watermark"}],baseURL:"/",ui_str:{to_prev:"上一篇",to_next:"下一篇",related_posts:"相关文章"},blog:{layout:e,title:"Write a control panel for my API-based CMS for Nuxt",description:"April CMS, a CMS that operates text files and serves with both interface and API, built for serving blog contents, come and check it out~",tags:i,comments:!0,related_blog:[s,c],slug:o,date:d,content:'<p><h3> </h3><ul><li><a href="#A_true_CMS_1">A true CMS</a></li><li><a href="#What_I_need_for_backend_23">What I need for backend</a></li><li><a href="#What_I_need_for_frontend_32">What I need for front-end</a></li><li><a href="#Actual_codes_for_backend_53">Actual codes for backend</a></li><ul><li><a href="#Dependencies_for_API_55">Dependencies for API</a></li><li><a href="#To_return_unrendered_Markdown_when_called_103">To return unrendered Markdown when called</a></li><li><a href="#Add_Backend_UI_for_API_238">Add Backend UI for API</a></li><li><a href="#To_save_and_delete_file_265">To save and delete file</a></li></ul><li><a href="#Actual_codes_for_frontend_300">Actual codes for front-end</a></li><ul><li><a href="#To_call_API_and_Markdown_302">To call API and Markdown</a></li><li><a href="#Points_to_notice_when_rendering_Markdown_309">Points to notice when rendering Markdown</a></li><li><a href="#Add_smooth_scrolling_effect_353">Add smooth scrolling effect</a></li></ul><li><a href="#Here_is_what_it_looks_like_381">Here is what it looks like</a></li><li><a href="#Experience_from_this_393">Experience from this</a></li></ul></p>\n<h1><a id="A_true_CMS_1"></a>A true CMS</h1>\n<p>This is a translation of original article <a href="/blog/editor-for-my-cms-of-my-nuxt-blog">给Nuxt使用的基于API的CMS——还有管理后台呢</a>.</p>\n<p>Github repo: <a href="https://github.com/c53hzn/april-cms">https://github.com/c53hzn/april-cms</a></p>\n<p>Last year when I started to learn <code>Nuxt</code>, I read a lot about <code>Headless CMS</code>, it can be called a <code>CMS without front-end page design</code> according to my understanding. I studied some of these projects and methods to use them, and tried to use one myself, but did not make it to the end. I still wanted to build up my website without relying on these external services. Although for comment system and visitor counter I might still be using external services as long as I\'m building static website.</p>\n<p>Then I managed to write an <code>API</code> to serve as a <code>CMS</code>, you can refer to <a href="blog/nuxt-blog-static-website-en">this article</a>.</p>\n<p>This <code>API</code> allows me to update my <code>Markdown</code> articles and use <code>Nuxt</code> to generate static page files, then I can push them to Github and update my website.</p>\n<p>Usually I use <code>Sublime Text</code> to write codes, this editor can show working documents on the left, and it is easy to switch between files.</p>\n<blockquote>\n<p>But humans tend to go on a hard way.</p>\n<p>by Me</p>\n</blockquote>\n<p>I want a <code>CMS</code> with an interface, and I can create/ modify/ read/ save/ delete in that interface. Also I  don\'t want a database, I just want to work on the <code>Markdown</code> files.</p>\n<p>I think I can do it.</p>\n<h1><a id="What_I_need_for_backend_23"></a>What I need for backend</h1>\n<p>I wrote my <code>API</code> with <code>express</code> framework under <code>Node</code> environment, and I still want to achieve more with the same structure, so there are a few methods that I need to master, like:</p>\n<ol>\n<li>Make the <code>API</code> to read static HTML page and return a <code>CMS</code> UI on the browser.</li>\n<li>When the <code>API</code> is started, the browser will automatically be opened and go to the <code>CMS</code> control panel.</li>\n<li>Make the <code>API</code> to receive data sent from browser(clients) and save on local computer.</li>\n<li>Make the <code>API</code> to receive data sent from browser and delete related file.</li>\n</ol>\n<h1><a id="What_I_need_for_frontend_32"></a>What I need for front-end</h1>\n<p>I had a <a href="https://www.codepen.io">CodePen</a> project <a href="https://codepen.io/c53hzn/full/YzzRzxR">Markdown Previewer</a> that only has fewer than 5 visits in the last half year. It would be a shame to leave it there, and it might be better if I can use it here.</p>\n<p>The CodePen project was rendered with <code>marked</code>, while my API was rendered with <code>markdown-it</code>. In order to consolidate my codes, I decided to change the renderer to <code>markdown-it</code>.</p>\n<p>The project was written with <code>jQuery</code>, I decided to continue using <code>jQuery</code> for the front-end page interaction after some comparison.</p>\n<p>Here are some issues that we need to solve:</p>\n<ol>\n<li>To read article list from <code>API</code> and render it in article list ares.</li>\n<li>To read article contents from <code>API</code> and fill in title/ tags/ description/ related blogs/ main contents to relevant input box or textarea, and then the preview area</li>\n<li>Every time there is a change in the <code>Markdown</code> editor, the preview area should be updated simultaneously, it also should have code highlight and normal HTML styles.</li>\n<li>When <code>Save post</code> is clicked, the page should confirm is all input boxed are filled, if <code>No</code> then page will <code>alert</code> that user should fill in all blanks. If <code>Yes</code> then check if article already exists, if <code>Yes</code> then <code>confirm</code> if need to update post, if <code>No</code> then <code>confirm</code> if need to create new post.</li>\n<li>When <code>Delete post</code> is clicked, the page should crosscheck if <code>slug</code> exists in post list, if <code>No</code> then <code>alert</code> that there is nothing to delete, if <code>Yes</code> then <code>confirm</code> if really need to delete.。</li>\n<li>When <code>Ctrl+enter</code> is pressed on keyboard, <code>save</code> action should be triggered.</li>\n<li>When creating or updating, the browser will use <code>post</code> method in <code>jQuery</code> to submit contents to server and receive result and reflect it to browser.</li>\n<li>When deleting, the browser will use use <code>post</code> method in <code>jQuery</code> to submit the <code>slug</code> of the post to server, then receive result of deletion and reflect it to browser.</li>\n</ol>\n<p>All actions should be completed in the same page.</p>\n<h1><a id="Actual_codes_for_backend_53"></a>Actual codes for backend</h1>\n<h2><a id="Dependencies_for_API_55"></a>Dependencies for API</h2>\n<p>First <code>require</code> all the dependencies and other required modules.</p>\n<pre class=\'hljs\'><code class="language-javascript"><span class="hljs-keyword">var</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">"express"</span>);\n<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);\n<span class="hljs-keyword">var</span> fm = <span class="hljs-built_in">require</span>(<span class="hljs-string">\'front-matter\'</span>);\n<span class="hljs-keyword">var</span> hljs = <span class="hljs-built_in">require</span>(<span class="hljs-string">\'highlight.js\'</span>);\n<span class="hljs-keyword">var</span> yaml = <span class="hljs-built_in">require</span>(<span class="hljs-string">"yaml"</span>);\n<span class="hljs-keyword">var</span> markdownIt = <span class="hljs-built_in">require</span>(<span class="hljs-string">\'markdown-it\'</span>);\n<span class="hljs-keyword">var</span> markdownItToc = <span class="hljs-built_in">require</span>(<span class="hljs-string">\'markdown-it-toc\'</span>);\n<span class="hljs-keyword">var</span> open = <span class="hljs-built_in">require</span>(<span class="hljs-string">"open"</span>);\n<span class="hljs-keyword">var</span> config = <span class="hljs-built_in">require</span>(__dirname+<span class="hljs-string">"\\\\config.js"</span>);\n\n<span class="hljs-keyword">var</span> app = express();\n<span class="hljs-keyword">var</span> md = markdownIt({\n  <span class="hljs-attr">html</span>:         <span class="hljs-literal">false</span>,        <span class="hljs-comment">// 在源码中启用 HTML 标签</span>\n  xhtmlOut:     <span class="hljs-literal">false</span>,        <span class="hljs-comment">// 使用 \'/\' 来闭合单标签 （比如 &lt;br /&gt;）。</span>\n  breaks:       <span class="hljs-literal">false</span>,        <span class="hljs-comment">// 转换段落里的 \'\\n\' 到 &lt;br&gt;。</span>\n  langPrefix:   <span class="hljs-string">\'language-\'</span>,  <span class="hljs-comment">// 给围栏代码块的 CSS 语言前缀。对于额外的高亮代码非常有用。</span>\n  linkify:      <span class="hljs-literal">false</span>,        <span class="hljs-comment">// 将类似 URL 的文本自动转换为链接。</span>\n  typographer:  <span class="hljs-literal">false</span>,\n  <span class="hljs-attr">quotes</span>: <span class="hljs-string">\'“”‘’\'</span>,\n  <span class="hljs-attr">highlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, lang</span>) </span>{\n    <span class="hljs-keyword">if</span> (lang &amp;&amp; hljs.getLanguage(lang)) {\n      <span class="hljs-keyword">try</span> {\n        <span class="hljs-keyword">return</span> hljs.highlight(lang, str).value;\n      } <span class="hljs-keyword">catch</span> (__) {}\n    }\n    <span class="hljs-keyword">return</span> <span class="hljs-string">\'\'</span>; <span class="hljs-comment">// 使用额外的默认转义</span>\n  }\n});\nmd.use(markdownItToc);\n</code></pre>\n<p>The <code>config</code> here is an extra configuration file that I added, the contents inside it is simple:</p>\n<pre class=\'hljs\'><code class="language-javascript"><span class="hljs-keyword">var</span> config = {\n\t<span class="hljs-attr">isSlugUseDate</span>: <span class="hljs-literal">false</span>,\n\t<span class="hljs-attr">blogPath</span>: __dirname + <span class="hljs-string">\'\\\\blog\'</span>,\n\t<span class="hljs-attr">imgPath</span>: __dirname + <span class="hljs-string">\'\\\\img\\\\blog\'</span>\n};\n<span class="hljs-built_in">module</span>.exports = config;\n</code></pre>\n<p>This <code>config</code> is to control the <code>Markdown</code> file path and image file path, and also whether to use date when it comes to <code>slug</code>. If <code>slug</code> uses date, then it will be a long <code>slug</code>, like <code>2020-04-26-editor-for-my-cms-of-my-nuxt-blog-en</code>. If <code>slug</code> does not use date, then it will be a short <code>slug</code>, like <code>editor-for-my-cms-of-my-nuxt-blog-en</code>, and the real blog <code>URL</code> will also be changed with it.</p>\n<h2><a id="To_return_unrendered_Markdown_when_called_103"></a>To return unrendered Markdown when called</h2>\n<p>First do some settings in the <code>API</code> entry point file <code>app.js</code>, this is to control whether to return <code>Markdown</code> or rendered <code>HTML</code> contents, and <code>API</code> will also return contents according to <code>slug</code> in request based on configuration.</p>\n<pre class=\'hljs\'><code class="language-JavaScript"><span class="hljs-keyword">var</span> slugToFileName = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">slug,isSlugUseDate</span>) </span>{\n  <span class="hljs-keyword">var</span> result = <span class="hljs-string">""</span>;\n  <span class="hljs-keyword">if</span> (isSlugUseDate) {\n    result = slug+<span class="hljs-string">".md"</span>;\n  } <span class="hljs-keyword">else</span> {\n    <span class="hljs-keyword">var</span> files = fs.readdirSync(config.blogPath);\n    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {\n      <span class="hljs-keyword">let</span> tempSlug = files[i].substring(<span class="hljs-number">11</span>,files[i].length);\n      <span class="hljs-keyword">if</span> (tempSlug == slug+<span class="hljs-string">".md"</span>) {\n        result = files[i];\n        <span class="hljs-keyword">break</span>;\n      }\n    }\n  }\n  <span class="hljs-keyword">return</span> result;\n}\n<span class="hljs-keyword">var</span> fileNameToSlug = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">filename,isSlugUseDate</span>) </span>{\n  <span class="hljs-keyword">if</span> (isSlugUseDate) {\n    <span class="hljs-keyword">return</span> filename.substring(<span class="hljs-number">0</span>,filename.length<span class="hljs-number">-3</span>);\n  } <span class="hljs-keyword">else</span> {\n    <span class="hljs-keyword">return</span> filename.substring(<span class="hljs-number">11</span>,filename.length<span class="hljs-number">-3</span>);\n  }\n}\n<span class="hljs-keyword">var</span> singleBlog = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fullPath,slug,isContentRequired,isMD,isDev</span>) </span>{\n  <span class="hljs-keyword">var</span> blog = {};\n  <span class="hljs-keyword">var</span> content = fm(fs.readFileSync(fullPath, <span class="hljs-string">"utf8"</span>));\n  blog = content.attributes;\n  blog.slug = slug;\n  <span class="hljs-keyword">var</span> fullFilename = fullPath.replace(config.blogPath+<span class="hljs-string">"\\\\"</span>,<span class="hljs-string">""</span>);\n  blog.date = fullFilename.substring(<span class="hljs-number">0</span>,<span class="hljs-number">10</span>);\n  <span class="hljs-keyword">if</span> (isContentRequired &amp;&amp; !isMD) {\n    <span class="hljs-keyword">let</span> html = md.render(<span class="hljs-string">\'@[toc]( )\\n\'</span> + content.body);\n    <span class="hljs-comment">//if isDev then use absolute path for images</span>\n    <span class="hljs-keyword">if</span> (isDev) {\n      html = html.replace(<span class="hljs-regexp">/src=\\"(\\/)?img/g</span>,<span class="hljs-string">"src=\\"http://127.0.0.1:4000/img"</span>);\n    }\n    <span class="hljs-comment">// add class "hljs" for dark theme rendering</span>\n    blog.content = html.replace(<span class="hljs-regexp">/\\&lt;pre/g</span>,<span class="hljs-string">"&lt;pre class=\'hljs\'"</span>);\n  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isContentRequired &amp;&amp; isMD) {\n    blog.content = content.body;\n  }\n  <span class="hljs-keyword">return</span> blog;\n}\n<span class="hljs-comment">//return blog related contents</span>\napp.get(<span class="hljs-string">"/blog"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{\n  <span class="hljs-comment">// allow cross orign access</span>\n  res.header(<span class="hljs-string">\'Access-Control-Allow-Origin\'</span>, <span class="hljs-string">\'*\'</span>);\n  <span class="hljs-keyword">var</span> blogPath = config.blogPath;\n  <span class="hljs-keyword">var</span> imgPath = config.imgPath;\n  <span class="hljs-keyword">var</span> files = fs.readdirSync(blogPath);\n  <span class="hljs-keyword">var</span> json = {};<span class="hljs-comment">// result to be returned</span>\n  <span class="hljs-keyword">var</span> qSlug = req.query.slug || <span class="hljs-string">""</span>;\n  <span class="hljs-keyword">var</span> qTag = req.query.tag || <span class="hljs-string">""</span>;\n  <span class="hljs-keyword">var</span> qImg = req.query.img || <span class="hljs-string">""</span>;\n  <span class="hljs-keyword">var</span> qIsMD = req.query.ismd == <span class="hljs-string">"true"</span>;\n  <span class="hljs-keyword">var</span> qIsDev = req.query.isdev == <span class="hljs-string">"true"</span>;\n  <span class="hljs-keyword">var</span> isSlugUseDate = (req.query.iseditor == <span class="hljs-string">"true"</span>)?<span class="hljs-literal">true</span>:config.isSlugUseDate;\n  <span class="hljs-keyword">if</span> (qSlug) {<span class="hljs-comment">// with blog slug query</span>\n    json = singleBlog(<span class="hljs-string">`<span class="hljs-subst">${blogPath}</span>\\\\<span class="hljs-subst">${slugToFileName(qSlug,isSlugUseDate)}</span>`</span>,qSlug,<span class="hljs-literal">true</span>,qIsMD,qIsDev);\n    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> k = <span class="hljs-number">0</span>; k &lt; files.length; k++) {<span class="hljs-comment">// add prev and next blog</span>\n      <span class="hljs-keyword">if</span> (qSlug == fileNameToSlug(files[k],isSlugUseDate)) {\n        <span class="hljs-keyword">if</span> (k === <span class="hljs-number">0</span>) {\n          json.next = fileNameToSlug(files[k+<span class="hljs-number">1</span>],isSlugUseDate);\n        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (k === files.length<span class="hljs-number">-1</span>) {\n          json.prev = fileNameToSlug(files[k<span class="hljs-number">-1</span>],isSlugUseDate);\n        } <span class="hljs-keyword">else</span> {\n          json.prev = fileNameToSlug(files[k<span class="hljs-number">-1</span>],isSlugUseDate);\n          json.next = fileNameToSlug(files[k+<span class="hljs-number">1</span>],isSlugUseDate);\n        }\n      }\n    }\n  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (qTag) {<span class="hljs-comment">// with tag query</span>\n    <span class="hljs-keyword">if</span> (qTag == <span class="hljs-string">"all_tags"</span>) {<span class="hljs-comment">// returns list of all available tags</span>\n      json.tags = {};\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {\n        <span class="hljs-keyword">let</span> blogPost = singleBlog(blogPath+<span class="hljs-string">"\\\\"</span>+files[i],fileNameToSlug(files[i],isSlugUseDate));\n        <span class="hljs-keyword">let</span> tags = blogPost.tags || [<span class="hljs-string">\'none\'</span>];\n        <span class="hljs-keyword">let</span> entry = {\n          <span class="hljs-attr">title</span>: blogPost.title,\n          <span class="hljs-attr">slug</span>: blogPost.slug\n        };\n        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; tags.length; j++) {\n          <span class="hljs-keyword">if</span> (json.tags[tags[j]]) {\n            json.tags[tags[j]]++;\n          } <span class="hljs-keyword">else</span> {\n            json.tags[tags[j]] = <span class="hljs-number">1</span>;\n          }\n        }\n      }\n    } <span class="hljs-keyword">else</span> {<span class="hljs-comment">// returns blog list of specific tag</span>\n      json.blogs = [];\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {\n        <span class="hljs-keyword">let</span> blogPost = singleBlog(blogPath+<span class="hljs-string">"\\\\"</span>+files[i],fileNameToSlug(files[i],isSlugUseDate));\n        <span class="hljs-keyword">let</span> tags = blogPost.tags || [<span class="hljs-string">\'none\'</span>];\n        <span class="hljs-keyword">let</span> entry = {\n          <span class="hljs-attr">title</span>: blogPost.title,\n          <span class="hljs-attr">slug</span>: blogPost.slug\n        };\n        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; tags.length; j++) {\n          <span class="hljs-keyword">if</span> (tags[j] == qTag) {\n            json.blogs.unshift(blogPost);\n          }\n        }\n      }\n    }\n  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (qImg) {<span class="hljs-comment">// with img query</span>\n    <span class="hljs-keyword">if</span> (qImg == <span class="hljs-string">"all_imgs"</span>) {\n      json.imgs = {};\n      <span class="hljs-keyword">var</span> imgFolders = fs.readdirSync(imgPath);\n      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; imgFolders.length; i++) {\n        <span class="hljs-keyword">let</span> imgs = fs.readdirSync(imgPath+<span class="hljs-string">"\\\\"</span>+imgFolders[i]);\n        json.imgs[imgFolders[i]] = imgs;\n      }\n    }\n  } <span class="hljs-keyword">else</span> {<span class="hljs-comment">//without requirement, returns list of all blogs</span>\n    json.blogs = [];\n    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++) {\n      <span class="hljs-keyword">let</span> blogPost = singleBlog(blogPath+<span class="hljs-string">"\\\\"</span>+files[i],fileNameToSlug(files[i],isSlugUseDate));\n      json.blogs.unshift(blogPost);\n    }\n  }\n  res.send(json);\n});\napp.get(<span class="hljs-string">"/config"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>) </span>{\n  <span class="hljs-comment">// allow cross orign access</span>\n  res.header(<span class="hljs-string">\'Access-Control-Allow-Origin\'</span>, <span class="hljs-string">\'*\'</span>);\n  res.send(config);\n});\n</code></pre>\n<h2><a id="Add_Backend_UI_for_API_238"></a>Add Backend UI for API</h2>\n<p>The entry point for Backend UI is <code>app.html</code>, and in order to access the static page <code>app.html</code>, you need codes below:</p>\n<pre class=\'hljs\'><code>//return blog content editor page\napp.use(express.static(__dirname));\napp.get(&quot;/&quot;, function(req, res) {\n    // allow cross orign access\n  res.header(\'Access-Control-Allow-Origin\', \'*\');\n  res.sendFile(__dirname+&quot;\\\\app.html&quot;);\n});\n/* nuxt is using port 3000, so choose another one */\napp.listen(4000, () =&gt; {\n  console.log(&quot;express server running at http://127.0.0.1:4000&quot;)\n});\n</code></pre>\n<p>Then the entry link for the <code>CMS</code> should be <code>http://127.0.0.1:4000/</code>.</p>\n<p>In order to start <code>API</code> and open browser to access this page, you will need an <code>npm</code> called <code>open</code>. Just write one line of command.</p>\n<pre class=\'hljs\'><code class="language-JavaScript">open(<span class="hljs-string">"http:127.0.0.1:4000/"</span>,{<span class="hljs-attr">app</span>: <span class="hljs-string">"chrome.exe"</span>});\n</code></pre>\n<p>This will open browser and go to <code>CMS</code> control panel. There is only one page for the control panel, so it\'s easy to manage.</p>\n<h2><a id="To_save_and_delete_file_265"></a>To save and delete file</h2>\n<p>Then there is the need for receiving data from browser and save it to local computer, or receiving data from browser and delete relevant file.</p>\n<pre class=\'hljs\'><code class="language-JavaScript"><span class="hljs-comment">//api to submit post</span>\n<span class="hljs-comment">// Parse URL-encoded bodies (as sent by HTML forms)</span>\napp.use(express.urlencoded({ <span class="hljs-attr">extended</span>: <span class="hljs-literal">true</span> }));\n<span class="hljs-comment">// Parse JSON bodies (as sent by API clients)</span>\napp.use(express.json());\n<span class="hljs-comment">// Access the parse results as request.body</span>\napp.post(<span class="hljs-string">\'/savepost\'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>)</span>{\n  <span class="hljs-keyword">var</span> obj = req.body;\n  <span class="hljs-keyword">var</span> fileName = config.blogPath+<span class="hljs-string">"\\\\"</span>+obj.slug+<span class="hljs-string">".md"</span>;\n    fs.writeFileSync(fileName, obj.str);\n    <span class="hljs-comment">//Client will get status of failure w/o this</span>\n    <span class="hljs-comment">//even if data is saved to server successfully</span>\n    res.send({<span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>});\n});\n<span class="hljs-comment">// delete post</span>\napp.post(<span class="hljs-string">\'/deletepost\'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">req, res</span>)</span>{\n  <span class="hljs-keyword">var</span> obj = req.body;\n  <span class="hljs-keyword">var</span> fileName = config.blogPath+<span class="hljs-string">"\\\\"</span>+obj.slug+<span class="hljs-string">".md"</span>;\n  <span class="hljs-keyword">try</span> {\n    fs.unlinkSync(fileName);\n    <span class="hljs-comment">//file removed</span>\n  } <span class="hljs-keyword">catch</span>(err) {\n    <span class="hljs-built_in">console</span>.error(err);\n  }\n    <span class="hljs-comment">//Client will get status of failure w/o this</span>\n    <span class="hljs-comment">//even if data is saved to server successfully</span>\n    res.send({<span class="hljs-string">"status"</span>: <span class="hljs-string">"success"</span>});\n});\n</code></pre>\n<h1><a id="Actual_codes_for_frontend_300"></a>Actual codes for front-end</h1>\n<h2><a id="To_call_API_and_Markdown_302"></a>To call API and Markdown</h2>\n<p>There is not much to say about the full codes. To get post list, you can call <code>/blogs</code> with <code>jQuery</code>\'s <code>getJSON</code> method, and to save post you can call <code>/savepost</code>, and to delete post you can call <code>/deletepost</code>, both with <code>post</code> method in <code>jQuery</code>.</p>\n<p>You can get <code>Markdown</code> contents from the editor in UI and use <code>markdown-it</code> to render to the preview area, also don\'t forget the <code>highlight.js</code> and <code>markdown-it-toc</code> plugins, then import <code>github-markdown</code>\nand the <code>css</code> for <code>highlight.js</code> to render the converted <code>HTML</code>, it\'s almost done.</p>\n<h2><a id="Points_to_notice_when_rendering_Markdown_309"></a>Points to notice when rendering Markdown</h2>\n<p>Here you might want to take a look at the usage for those <code>Node</code> when applying them to browser.</p>\n<p>When it was just <code>Node</code> script, first you <code>require</code> them.</p>\n<pre class=\'hljs\'><code class="language-JavaScript"><span class="hljs-keyword">var</span> markdownIt = <span class="hljs-built_in">require</span>(<span class="hljs-string">\'markdown-it\'</span>);\n<span class="hljs-keyword">var</span> hljs = <span class="hljs-built_in">require</span>(<span class="hljs-string">\'highlight.js\'</span>);\n<span class="hljs-keyword">var</span> markdownItToc = <span class="hljs-built_in">require</span>(<span class="hljs-string">\'markdown-it-toc\'</span>);\n</code></pre>\n<p>Then you configure them.</p>\n<pre class=\'hljs\'><code class="language-JavaScript"><span class="hljs-keyword">var</span> md = markdownIt({\n  <span class="hljs-attr">html</span>:         <span class="hljs-literal">false</span>,\n  <span class="hljs-attr">xhtmlOut</span>:     <span class="hljs-literal">false</span>,\n  <span class="hljs-attr">breaks</span>:       <span class="hljs-literal">false</span>,\n  <span class="hljs-attr">langPrefix</span>:   <span class="hljs-string">\'language-\'</span>,\n  <span class="hljs-attr">linkify</span>:      <span class="hljs-literal">false</span>,\n  <span class="hljs-attr">typographer</span>:  <span class="hljs-literal">false</span>,\n  <span class="hljs-attr">quotes</span>: <span class="hljs-string">\'“”‘’\'</span>,\n  <span class="hljs-attr">highlight</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, lang</span>) </span>{\n    <span class="hljs-keyword">if</span> (lang &amp;&amp; hljs.getLanguage(lang)) {\n      <span class="hljs-keyword">try</span> {\n        <span class="hljs-keyword">return</span> hljs.highlight(lang, str).value;\n      } <span class="hljs-keyword">catch</span> (__) {}\n    }\n    <span class="hljs-keyword">return</span> <span class="hljs-string">\'\'</span>;\n  }\n});\nmd.use(markdownItToc);\n</code></pre>\n<p>Now you can use it to render <code>Markdown</code>.</p>\n<p>But when I used the same settings for browser, there is always error saying this or that object is not found.</p>\n<p>Then I discovered that the variables exposed by original authors have different casing comparing to my settings.</p>\n<p>I opened those <code>.js</code> files and check the variables one by one and found that <code>markdown-it</code> used <code>markdownit</code> as global variable, and <code>markdown-it-toc</code>, the plugin that I used for generating anchor links, used <code>markdownitTOC</code> as global variable. After changing my settings, the script is finally OK to run</p>\n<p>This should not have been a problem, I\'m really upset about it.</p>\n<h2><a id="Add_smooth_scrolling_effect_353"></a>Add smooth scrolling effect</h2>\n<p>I added anchor links for preview area, and I want those <code>#</code> links will not direct the page to those internal links, but rather have the page scroll to relevant position smoothly, here are the codes:</p>\n<pre class=\'hljs\'><code class="language-JavaScript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updatePreview</span>(<span class="hljs-params"></span>)</span>{\n  <span class="hljs-keyword">var</span> d = <span class="hljs-built_in">document</span>;\n  <span class="hljs-keyword">var</span> source = $(<span class="hljs-string">"#editor"</span>).val();\n  <span class="hljs-keyword">var</span> html = <span class="hljs-string">"\\t"</span> + md.render(<span class="hljs-string">\'[toc]\\n\'</span> + source);\n  html = html.replace(<span class="hljs-regexp">/\\&lt;a/g</span>,<span class="hljs-string">"&lt;a target=\'_blank\'"</span>);\n  $(<span class="hljs-string">"#preview"</span>).html(html);\n  <span class="hljs-comment">//add scrollIntoView to anchor link</span>\n  <span class="hljs-keyword">var</span> aTags = d.querySelectorAll(<span class="hljs-string">"a[href]"</span>);\n  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; aTags.length; i++) {\n    <span class="hljs-keyword">if</span> (aTags[i].href.indexOf(<span class="hljs-string">"#"</span>) !== <span class="hljs-number">-1</span>) {\n      aTags[i].onclick = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{\n        <span class="hljs-keyword">var</span> c = e || event;\n        c.preventDefault();\n        <span class="hljs-keyword">var</span> href = aTags[i].href;\n        <span class="hljs-keyword">var</span> hashPos = href.indexOf(<span class="hljs-string">"#"</span>);\n        <span class="hljs-keyword">var</span> id = href.substring(hashPos+<span class="hljs-number">1</span>, href.length);\n        d.querySelector(<span class="hljs-string">"a[id=\'"</span>+<span class="hljs-built_in">String</span>(id)+<span class="hljs-string">"\']"</span>).scrollIntoView({<span class="hljs-attr">behavior</span>: <span class="hljs-string">"smooth"</span>});\n      }\n    }\n  }\n}\n</code></pre>\n<h1><a id="Here_is_what_it_looks_like_381"></a>Here is what it looks like</h1>\n<p>When you need to access this <code>API</code>, you can <code>cd</code> to that folder and</p>\n<pre class=\'hljs\'><code>node index.js\n</code></pre>\n<p>Then browser will open itself and be directed to <code>http://127.0.0.1:4000/</code>, you will be able to see post list, and be able to create/delete/modify articles, see the capture below</p>\n<p><img src="/img/blog/2020-04-19/001.png" alt="preview"></p>\n<h1><a id="Experience_from_this_393"></a>Experience from this</h1>\n<p>I finished what I started a year ago, and it only took me one day, I\'m really happy about it.</p>\n<p>If I am to give a name to this CMS, I think I will call it <code>April CMS</code>, because I finished it in April.</p>\n<p>After finishing it, I did some study and think that, this <code>CMS</code> fits both descriptions of <code>API-based Headless CMS</code> and <code>Flat File CMS</code>, which is <code>a CMS that operates on text files rather than databases</code>. Seems good!</p>\n<p>And the preview area and post list area will update themselves as you input and save or delete post, it will be really smooth when you write with it, maybe it can be used for writing documents or stories.</p>\n<p>Don\'t know what more compliments can I say about it :)</p>\n<p>On top of it, this <code>CMS</code> is a useful thing, and I hope I can create more useful stuff in the future.</p>\n',prev:s,next:"enable-spellcheck-on-chrome-en"},tags:i,date:d}],fetch:[],error:null,serverRendered:!0,routePath:"/blog/editor-for-my-cms-of-my-nuxt-blog-en"}}("editor-for-my-cms-of-my-nuxt-blog","JavaScript","post","jQuery","2019-05-05-nuxt-blog-static-website","Node.js","editor-for-my-cms-of-my-nuxt-blog-en","English","Tech","nuxt-blog-static-website-en",Array(6),"2020-04-26")</script><script src="/_nuxt/a473fe36ef481c01f030.js" defer></script><script src="/_nuxt/ae4116cfdfc058b526d5.js" defer></script><script src="/_nuxt/275bef93b4559841d52d.js" defer></script><script src="/_nuxt/54e959968381881adf64.js" defer></script>
  </body>
</html>
