<!doctype html>
<html data-n-head-ssr>
  <head>
    <title>Write a JavaScript script for Photoshop image batch processing | Jenny的小站</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="I made a JavaScript script to bulk resize image and canvas, then add watermark and save as new image, learnt a lot during this process."><meta data-n-head="ssr" data-hid="keyword" name="keyword" content="English, JavaScript, Photoshop, Batch Process, Tech"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/img/favicon.ico"><link data-n-head="ssr" rel="stylesheet" href="/css/font-gugi.css"><link data-n-head="ssr" rel="stylesheet" href="/css/font-poppins.css"><link data-n-head="ssr" rel="stylesheet" href="/css/style.css?2020-04-12"><link data-n-head="ssr" rel="stylesheet" href="/font-awesome/css/font-awesome.min.css"><link data-n-head="ssr" rel="stylesheet" href="/css/github-markdown.min.css"><link data-n-head="ssr" rel="stylesheet" href="/css/hljs.dark.min.css"><link data-n-head="ssr" rel="stylesheet" href="https://hzn-website.000webhostapp.com/disqus/dist/iDisqus.min.css"><script data-n-head="ssr" src="/js/statcounter.js"></script><script data-n-head="ssr" data-ad-client="ca-pub-2790001673900763" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><base href="/"><link rel="preload" href="/_nuxt/5b0027e8e089eb910acf.js" as="script"><link rel="preload" href="/_nuxt/0432c1a2dd8b48d52e80.js" as="script"><link rel="preload" href="/_nuxt/2cf4f1d92facee93c1c1.js" as="script"><link rel="preload" href="/_nuxt/5501b08dff52e3b9135b.js" as="script"><style data-vue-ssr-id="3191d5ad:0 72520070:0 f28bdea2:0">.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#3b8070;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}.markdown-body{margin-bottom:50px}.markdown-body img{max-height:100px}a[id]{position:relative;top:-40px;display:block}a#comment-link{top:0}.blog-desc{margin:10px;padding:10px;color:#666;background-color:rgba(0,0,0,.025)}.youtube-img{position:relative;display:inline-block}.youtube-img:before{width:40%;height:40%;border-radius:25%;background:rgba(0,0,0,.7);transition:background .2s}.youtube-img:after,.youtube-img:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;margin:auto}.youtube-img:after{width:0;height:0;border-top:10px solid transparent;border-left:20px solid #fff;border-bottom:10px solid transparent}.youtube-img:hover:before{background:red}#disqus_thread{margin-top:20px}.prev-next{margin:20px auto;display:block}.prev-next:after{display:table;content:" ";clear:both}.prev-next a{display:inline}.next,.prev{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin:20px auto;width:100%;color:grey;border:1px solid grey;cursor:pointer}.prev{width:48%;text-align:left;float:left}.next{width:48%;text-align:right;float:right}.next:hover,.prev:hover{color:#000;border-color:#000}.prev p{padding-left:16px}.next p,.prev p{margin:0;padding-top:16px;padding-bottom:16px}.next p{padding-right:16px}#comment{margin-top:40px}.blog-gallery{margin:20px auto;display:flex;justify-content:center;flex-wrap:wrap;overflow:hidden}.blog-gallery-unit{margin:40px 20px 0;width:46%;border:1px solid silver;border-radius:5px}.blog-gallery-unit:first-child,.blog-gallery-unit:nth-child(2){margin-top:20px}.blog-gallery-unit:nth-child(2n-1){margin-left:0}.blog-gallery-unit:nth-child(2n){margin-right:0}.blog-gallery-unit:hover{border-color:#000}.blog-gallery-inner{padding:21px 10px 10px;height:100%}.blog-gallery-inner h4{margin-top:0;max-height:42px;overflow:hidden}.blog-gallery-desc{line-height:21px;max-height:64px;display:block;overflow:hidden}.blog-gallery-tag{margin:1px;padding:0 8px;color:#fff;font-size:12px;font-family:Microsoft Yahei;line-height:20px;border-radius:999px;background:grey;display:inline-block}@media (max-width:425px){.blog-gallery-unit{margin:20px 0 0;width:100%}}</style>
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div class="container"><nav><div class="nav-wrap"><header><a href="/" class="no-decor-link"><p class="nav-home">Jenny's blog</p></a></header> <div class="nav-btn"><div class="bar"></div> <div class="bar"></div> <div class="bar"></div> <div class="bar"></div></div> <div class="nav-mask"></div> <div class="body-mask"></div> <ul class="nav-ul"><span title="Change navigation to English" class="nav-link" style="padding-left:10px">English</span> <a href="/" target="_self" class="nav-link"><li>首页<!----><!----></li></a><a href="/resume" target="_self" class="nav-link"><li>简历<!----><!----></li></a><a href="/portfolio" target="_self" class="nav-link"><li>作品集<!----><!----></li></a><a href="/blog" target="_self" class="nav-link nuxt-link-active"><li>博客<!----><!----></li></a><a href="https://wj.qq.com/s2/3731207/f0cd/" target="_blank" class="nav-link"><li>联系我<span> </span><i class="fa fa-external-link"></i></li></a></ul></div></nav> <main><div><section class="main-content"><h1 class="align-center">Write a JavaScript script for Photoshop image batch processing</h1> <p class="blog-date align-center"><span class="fa fa-calendar"> 2020-04-13</span></p> <p class="blog-tags align-center"><a href="/blog/tag/English"><span class="blog-tag">English</span></a><a href="/blog/tag/JavaScript"><span class="blog-tag">JavaScript</span></a><a href="/blog/tag/Photoshop"><span class="blog-tag">Photoshop</span></a><a href="/blog/tag/Batch Process"><span class="blog-tag">Batch Process</span></a><a href="/blog/tag/Tech"><span class="blog-tag">Tech</span></a></p> <div class="blog-desc">I made a JavaScript script to bulk resize image and canvas, then add watermark and save as new image, learnt a lot during this process.</div> <article class="markdown-body"><p></p><h3> </h3><ul><li><a href="blog/script-for-photoshop-bulk-resize-and-watermark-en#Preface_1">Preface</a></li><li><a href="blog/script-for-photoshop-bulk-resize-and-watermark-en#JavaScript_scripts_for_Photoshop_that_I_found_online_19">JavaScript scripts for Photoshop that I found online</a></li><li><a href="blog/script-for-photoshop-bulk-resize-and-watermark-en#Modify_the_scripts_to_fit_my_needs_34">Modify the scripts to fit my needs</a></li><li><a href="blog/script-for-photoshop-bulk-resize-and-watermark-en#Experience_from_this_153">Experience from this</a></li></ul><p></p>
<h1><a id="Preface_1"></a>Preface</h1>
<p>This is a translation of original article <a href="/blog/script-for-photoshop-bulk-resize-and-watermark">用JavaScript写一个Photoshop批处理脚本</a>.</p>
<p>Recently I need to add watermarks for a batch of images, I started to wonder if there are some technical methods to speed up this process after manually finished 3 images with Photoshop.</p>
<p>I have used <code>Actions</code> when I had to shoot photos and edit them all by myself. <code>Actions</code> can record and play repeating steps, I can use it to adjust image size and canvas size, or even add watermark image, merge layers and save in new folder.</p>
<p>But <code>Actions</code> has its limitations. This function cannot adjust image size and canvas size according to image shape, and the images that I have to process don't share the same shape, some of them need resizing based on their width, some on their height. If <code>Actions</code> fails at the first step, then there is no need to do the rest of the steps.</p>
<p>So I Googled relevant information to see if it is possible to customize <code>Actions</code> to meet my requirements. The result comes back positive, but there are only a few conditions to use, and they still cannot solve my problem.</p>
<p>Then I saw this post that said you can use <code>Photoshop Scripts</code> to do this, so I did some research on this and found that Photoshop accepts 3 scripting languages: <code>AppleScript</code>, <code>JavaScript</code> and <code>VBScript</code>.</p>
<p>How convenient that I happen to know one of these languages! <em>Among scripts used by everyone, JavaScript is always number one!</em> (Said by myself)</p>
<p>Let's start copying, no, start learning some tricks then.</p>
<h1><a id="JavaScript_scripts_for_Photoshop_that_I_found_online_19"></a>JavaScript scripts for Photoshop that I found online</h1>
<p>I found 3 JavaScript scripts for Photoshop that might be useful on Google.</p>
<ol>
<li>
<p><a href="https://ricardomoinhos.com/photoshop-scripting/" title="Photoshop Scripting – Batch resizing image size and image canvas">Photoshop Scripting – Batch resizing image size and image canvas</a><br>
This script can bulk adjust image size and canvas size and do something more and save them in new folder, I can modify it for my use.</p>
</li>
<li>
<p><a href="http://www.mouseprints.net/old/dpr/PlaceWatermark.jsx" title="JJMack's PlaceWatermark">JJMack's PlaceWatermark scripts</a><br>
This script can add watermark to images and adjust watermark position. I don't need adjusting since my watermark is exactly the same size as canvas size, so I can use this script after deleting some steps.</p>
</li>
<li>
<p><a href="https://community.adobe.com/t5/photoshop/help-need-a-script-to-merge-all-layers-even-if-there-is-only-one-layer/td-p/3301907?page=1" title="Merge all visible layers">Merge all visible layers</a><br>
There is one thing not mentioned in previous scripts--how to merge all layers. One reply in this page talked about how to merge all visible layers, since I will not use any invisible layers, this will do though.</p>
</li>
</ol>
<p>With the 3 scripts above, I can make my own script now.</p>
<h1><a id="Modify_the_scripts_to_fit_my_needs_34"></a>Modify the scripts to fit my needs</h1>
<p>What I want to do with my images is simple, first adjust image size to no more than <code>1333 x 1000 px</code> and keep the width/height ratio at the same time, then expand canvas to <code>1600 x 1200 px</code> and add a <code>1600 x 1200 px</code> watermark to it, merge watermark layer and background layer and save in a new folder, done.</p>
<p>If done by hand, I can finish one image in 30 seconds, but I can speed up the process and set my hands free with scripts, now I will have time for more cat videos on Youtube.</p>
<p>Also please note that the JS code file needs to be saved as <code>.jsx</code> format, you can click <code>File > Scripts > View</code> in Photoshop to select script and run it.</p>
<p>Full scripts is as follows</p>
<pre class="hljs"><code class="language-JavaScript">app.preferences.rulerUnits = Units.PIXELS;
<span class="hljs-keyword">if</span> (app.documents.length > <span class="hljs-number">0</span>) {<span class="hljs-comment">//If there is file left open</span>
  alert(<span class="hljs-string">"Please close all open documents before running this script."</span>);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// The width and height for output. You may have to change this to make it dynamic.</span>
  <span class="hljs-keyword">var</span> finalWidth = <span class="hljs-number">1600</span>;
  <span class="hljs-keyword">var</span> finalHeight = <span class="hljs-number">1200</span>;
  <span class="hljs-comment">// Use folder selection dialogs to get the location of the input files</span>
  <span class="hljs-comment">// and where to save the new output files.</span>
  <span class="hljs-keyword">var</span> sourceFolder = Folder.selectDialog(<span class="hljs-string">"Please choose the source image folder."</span>, Folder.myDocuments);
  <span class="hljs-keyword">var</span> destFolder = Folder.selectDialog(<span class="hljs-string">"Please choose the target image folder"</span>, sourceFolder);
  <span class="hljs-keyword">var</span> watermarkFile = File.openDialog(<span class="hljs-string">"Please choose a watermark image file."</span>, <span class="hljs-string">"*.png"</span>)
  <span class="hljs-comment">// Consider only some images filetypes.</span>
  <span class="hljs-keyword">var</span> files = sourceFolder.getFiles(<span class="hljs-regexp">/.+\.(?:jpe?g|bmp|png)$/i</span>);
  <span class="hljs-keyword">var</span> numOfFiles = files.length;
  <span class="hljs-comment">//Iterate through folder</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++){
    <span class="hljs-keyword">var</span> f = files[i];
    <span class="hljs-keyword">if</span> (f <span class="hljs-keyword">instanceof</span> Folder) {<span class="hljs-comment">//if file is folder, jump to next</span>
      <span class="hljs-keyword">continue</span>;
    }
    <span class="hljs-keyword">var</span> docRef = app.open(f);
    <span class="hljs-keyword">var</span> layerRef = docRef.activeLayer;
    <span class="hljs-comment">//Resize image according to shape</span>
    <span class="hljs-keyword">var</span> actualWidth = docRef.width;
    <span class="hljs-keyword">var</span> actualHeight = docRef.height;
    <span class="hljs-keyword">var</span> imgHeight = <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">var</span> imgWidth = actualWidth * imgHeight / actualHeight;
    <span class="hljs-keyword">if</span> (imgWidth > <span class="hljs-number">1333</span>) {
      imgWidth = <span class="hljs-number">1333</span>;
      imgHeight = actualHeight * imgWidth / actualWidth;
    }
    docRef.resizeImage(imgWidth,imgHeight);
    <span class="hljs-comment">//Resize canvas, keep img in center</span>
    docRef.resizeCanvas(finalWidth, finalHeight, AnchorPosition.MIDDLECENTER);
    <span class="hljs-comment">//Add watermark</span>
    app.bringToFront();
    <span class="hljs-keyword">var</span> logoFile = watermarkFile; 
    placeWatermark(logoFile);
    <span class="hljs-comment">//Merge visible layers, there is no mergeAllLayer function</span>
    <span class="hljs-keyword">try</span>{
        activeDocument.mergeVisibleLayers();
    } <span class="hljs-keyword">catch</span>(e) {}
    <span class="hljs-comment">//Get filename and extension to use it when saving.</span>
    <span class="hljs-keyword">var</span> fileExtension = getFileExtension(f.name);
    <span class="hljs-keyword">var</span> filename = getFilename(f.name);
    <span class="hljs-comment">//Create new image and save as JPG</span>
    <span class="hljs-keyword">var</span> outputFile = <span class="hljs-keyword">new</span> File(destFolder.absoluteURI + <span class="hljs-string">"/"</span> + filename + <span class="hljs-string">"."</span> + fileExtension);
    saveAsJPG(docRef, outputFile, <span class="hljs-number">10</span>);
    <span class="hljs-comment">//Close active document, this cannot be done w/o merging all layers</span>
    docRef.close();
  }
  alert(numOfFiles + <span class="hljs-string">" files have been processed."</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFileExtension</span>(<span class="hljs-params">fullFilename</span>) </span>{
  <span class="hljs-keyword">return</span> fullFilename.split(<span class="hljs-string">'.'</span>).pop();
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFilename</span>(<span class="hljs-params">fullFilename</span>) </span>{
  <span class="hljs-keyword">var</span> finalDotPosition = fullFilename.lastIndexOf(<span class="hljs-string">"."</span>) ;
  <span class="hljs-keyword">if</span> ( finalDotPosition > <span class="hljs-number">-1</span> ) {
    <span class="hljs-keyword">return</span> fullFilename.substr( <span class="hljs-number">0</span> , finalDotPosition );
  }
  <span class="hljs-keyword">return</span> fullFilename;
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveAsJPG</span>(<span class="hljs-params">docRef, saveFile, jpegQuality</span>) </span>{
  options = <span class="hljs-keyword">new</span> JPEGSaveOptions();
  options.quality = jpegQuality;
  docRef.saveAs(saveFile, options, <span class="hljs-literal">false</span>,Extension.LOWERCASE);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">placeWatermark</span>(<span class="hljs-params">Image</span>)</span>{  
  <span class="hljs-keyword">if</span>(!documents.length) {<span class="hljs-comment">// if no image is open then return</span>
    <span class="hljs-keyword">return</span>;
  } 
  <span class="hljs-keyword">var</span> fileObj = <span class="hljs-keyword">new</span> File(Image);<span class="hljs-comment">// the passed file</span>
  <span class="hljs-keyword">if</span>(!fileObj.exists){<span class="hljs-comment">// If watermark file does not exits tell user </span>
    alert(fileObj.name  + <span class="hljs-string">" does not exist!"</span>);<span class="hljs-comment">// Alert User </span>
    <span class="hljs-keyword">return</span>;
  }  
  <span class="hljs-keyword">try</span>{  
    <span class="hljs-keyword">var</span> doc = app.activeDocument;<span class="hljs-comment">// set Doc object to active document</span>
    app.displayDialogs = DialogModes.NO;<span class="hljs-comment">// Dialog off </span>
    <span class="hljs-keyword">var</span> strtRulerUnits = app.preferences.rulerUnits;<span class="hljs-comment">// Save Users ruler units </span>
    <span class="hljs-keyword">var</span> strtTypeUnits = app.preferences.typeUnits;<span class="hljs-comment">// Save Users Type units </span>
    app.preferences.rulerUnits = Units.PIXELS;<span class="hljs-comment">// work with pixels </span>
    app.preferences.typeUnits = TypeUnits.PIXELS;<span class="hljs-comment">// work with pixels </span>
    <span class="hljs-keyword">var</span> layers = app.activeDocument.layers;<span class="hljs-comment">// get layers</span>
    app.activeDocument.activeLayer = layers[<span class="hljs-number">0</span>];<span class="hljs-comment">// Target Top Layer</span>
    placeFile(fileObj);<span class="hljs-comment">// Place in file the Watermark png file</span>
  }
  <span class="hljs-keyword">catch</span>(e) { alert(e + <span class="hljs-string">': on line '</span> + e.line); }<span class="hljs-comment">// inform user of error</span>
  <span class="hljs-keyword">finally</span>{  
    app.preferences.rulerUnits = strtRulerUnits;<span class="hljs-comment">// Restore user ruler units  </span>
    app.preferences.typeUnits = strtTypeUnits;<span class="hljs-comment">// Restore user type units    </span>
  };
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">placeFile</span>(<span class="hljs-params">placeFile</span>) </span>{  
  <span class="hljs-keyword">var</span> desc21 = <span class="hljs-keyword">new</span> ActionDescriptor();  
  desc21.putPath( charIDToTypeID(<span class="hljs-string">'null'</span>), <span class="hljs-keyword">new</span> File(placeFile) );  
  desc21.putEnumerated( charIDToTypeID(<span class="hljs-string">'FTcs'</span>), charIDToTypeID(<span class="hljs-string">'QCSt'</span>), charIDToTypeID(<span class="hljs-string">'Qcsa'</span>) );  
  <span class="hljs-keyword">var</span> desc22 = <span class="hljs-keyword">new</span> ActionDescriptor();  
  desc22.putUnitDouble( charIDToTypeID(<span class="hljs-string">'Hrzn'</span>), charIDToTypeID(<span class="hljs-string">'#Pxl'</span>), <span class="hljs-number">0.000000</span> );  
  desc22.putUnitDouble( charIDToTypeID(<span class="hljs-string">'Vrtc'</span>), charIDToTypeID(<span class="hljs-string">'#Pxl'</span>), <span class="hljs-number">0.000000</span> );  
  desc21.putObject( charIDToTypeID(<span class="hljs-string">'Ofst'</span>), charIDToTypeID(<span class="hljs-string">'Ofst'</span>), desc22 );  
  executeAction( charIDToTypeID(<span class="hljs-string">'Plc '</span>), desc21, DialogModes.NO );  
}
</code></pre>
<h1><a id="Experience_from_this_153"></a>Experience from this</h1>
<p>I really like this saying(by myself) <em>"JavaScript is always number one"</em> now, so far I can finish most of the tech-related works with JavaScript, this alone is amazing.</p>
<p>But it seems that there are not many learning materials about JavaScript for Photoshop online, I'll have to wait til next time I encounter a problem to learn more then.</p>
<p>Thumb up for JavaScript here!</p>
</article> <div class="prev-next"><a href="/blog/script-for-photoshop-bulk-resize-and-watermark" class="no-decor-link"><div class="prev"><p>上一篇</p></div></a> <a href="/blog/editor-for-my-cms-of-my-nuxt-blog" class="no-decor-link"><div class="next"><p>下一篇</p></div></a></div> <div><h3 style="text-align:center"><span style="border-bottom:2px solid #000">相关文章</span></h3> <div class="blog-gallery"><div class="blog-gallery-unit"><a href="/blog/script-for-photoshop-bulk-resize-and-watermark" title="我攒了一个可以在Photoshop里批量调整图像大小和画布大小、添加水印、另存为的JavaScript脚本，又学到了不少东西。" class="no-decor-link"><div class="blog-gallery-inner align-left"><h4>用JavaScript写一个Photoshop批处理脚本</h4> <p class="blog-date"><span class="fa fa-calendar">
               2020-04-12
            </span></p> <p class="align-left"><span class="blog-gallery-desc">我攒了一个可以在Photoshop里批量调整图像大小和画布大小、添加水印、另存为的JavaScript脚本，又学到了不少东西。</span> <br> <span class="align-left"><span class="blog-gallery-tag">
                技术
              </span><span class="blog-gallery-tag">
                JavaScript
              </span><span class="blog-gallery-tag">
                Photoshop
              </span><span class="blog-gallery-tag">
                批处理
              </span></span></p></div></a></div></div></div> <div id="comment"></div></section></div></main> <footer><p>Created with Nuxt.js <br>
    	Made by  
    	<a href="https://github.com/c53hzn" target="_blank" class="no-decor-link"><strong>Jenny HOU</strong> <i class="fa fa-github font-20"></i></a></p> <div class="go-top go-top-hidden"><div class="arrow"></div> <div class="stick"></div></div></footer></div></div></div><script>window.__NUXT__=function(s,a,e,n,t,l,o,p){return l[0]=o,l[1]=e,l[2]=n,l[3]="Batch Process",l[4]="Tech",{layout:"page",data:[{relatedBlog:[{layout:a,title:"用JavaScript写一个Photoshop批处理脚本",description:"我攒了一个可以在Photoshop里批量调整图像大小和画布大小、添加水印、另存为的JavaScript脚本，又学到了不少东西。",tags:["技术",e,n,"批处理"],comments:!0,related_blog:["2020-04-13-script-for-photoshop-bulk-resize-and-watermark-en","2020-01-31-summary-of-my-life-in-2019"],slug:s,date:"2020-04-12",prev:"nuxt-blog-static-website-en",next:t}],baseURL:"/",ui_str_zh:{to_prev:"上一篇",to_next:"下一篇",related_posts:"相关文章"},ui_str_en:{to_prev:"Previous",to_next:"Next",related_posts:"Related Posts"},blog:{layout:a,title:"Write a JavaScript script for Photoshop image batch processing",description:"I made a JavaScript script to bulk resize image and canvas, then add watermark and save as new image, learnt a lot during this process.",tags:l,comments:!0,related_blog:[s],slug:t,date:p,content:'<p><h3> </h3><ul><li><a href="#Preface_1">Preface</a></li><li><a href="#JavaScript_scripts_for_Photoshop_that_I_found_online_19">JavaScript scripts for Photoshop that I found online</a></li><li><a href="#Modify_the_scripts_to_fit_my_needs_34">Modify the scripts to fit my needs</a></li><li><a href="#Experience_from_this_153">Experience from this</a></li></ul></p>\n<h1><a id="Preface_1"></a>Preface</h1>\n<p>This is a translation of original article <a href="/blog/script-for-photoshop-bulk-resize-and-watermark">用JavaScript写一个Photoshop批处理脚本</a>.</p>\n<p>Recently I need to add watermarks for a batch of images, I started to wonder if there are some technical methods to speed up this process after manually finished 3 images with Photoshop.</p>\n<p>I have used <code>Actions</code> when I had to shoot photos and edit them all by myself. <code>Actions</code> can record and play repeating steps, I can use it to adjust image size and canvas size, or even add watermark image, merge layers and save in new folder.</p>\n<p>But <code>Actions</code> has its limitations. This function cannot adjust image size and canvas size according to image shape, and the images that I have to process don\'t share the same shape, some of them need resizing based on their width, some on their height. If <code>Actions</code> fails at the first step, then there is no need to do the rest of the steps.</p>\n<p>So I Googled relevant information to see if it is possible to customize <code>Actions</code> to meet my requirements. The result comes back positive, but there are only a few conditions to use, and they still cannot solve my problem.</p>\n<p>Then I saw this post that said you can use <code>Photoshop Scripts</code> to do this, so I did some research on this and found that Photoshop accepts 3 scripting languages: <code>AppleScript</code>, <code>JavaScript</code> and <code>VBScript</code>.</p>\n<p>How convenient that I happen to know one of these languages! <em>Among scripts used by everyone, JavaScript is always number one!</em> (Said by myself)</p>\n<p>Let\'s start copying, no, start learning some tricks then.</p>\n<h1><a id="JavaScript_scripts_for_Photoshop_that_I_found_online_19"></a>JavaScript scripts for Photoshop that I found online</h1>\n<p>I found 3 JavaScript scripts for Photoshop that might be useful on Google.</p>\n<ol>\n<li>\n<p><a href="https://ricardomoinhos.com/photoshop-scripting/" title="Photoshop Scripting – Batch resizing image size and image canvas">Photoshop Scripting – Batch resizing image size and image canvas</a><br>\nThis script can bulk adjust image size and canvas size and do something more and save them in new folder, I can modify it for my use.</p>\n</li>\n<li>\n<p><a href="http://www.mouseprints.net/old/dpr/PlaceWatermark.jsx" title="JJMack\'s PlaceWatermark">JJMack\'s PlaceWatermark scripts</a><br>\nThis script can add watermark to images and adjust watermark position. I don\'t need adjusting since my watermark is exactly the same size as canvas size, so I can use this script after deleting some steps.</p>\n</li>\n<li>\n<p><a href="https://community.adobe.com/t5/photoshop/help-need-a-script-to-merge-all-layers-even-if-there-is-only-one-layer/td-p/3301907?page=1" title="Merge all visible layers">Merge all visible layers</a><br>\nThere is one thing not mentioned in previous scripts--how to merge all layers. One reply in this page talked about how to merge all visible layers, since I will not use any invisible layers, this will do though.</p>\n</li>\n</ol>\n<p>With the 3 scripts above, I can make my own script now.</p>\n<h1><a id="Modify_the_scripts_to_fit_my_needs_34"></a>Modify the scripts to fit my needs</h1>\n<p>What I want to do with my images is simple, first adjust image size to no more than <code>1333 x 1000 px</code> and keep the width/height ratio at the same time, then expand canvas to <code>1600 x 1200 px</code> and add a <code>1600 x 1200 px</code> watermark to it, merge watermark layer and background layer and save in a new folder, done.</p>\n<p>If done by hand, I can finish one image in 30 seconds, but I can speed up the process and set my hands free with scripts, now I will have time for more cat videos on Youtube.</p>\n<p>Also please note that the JS code file needs to be saved as <code>.jsx</code> format, you can click <code>File &gt; Scripts &gt; View</code> in Photoshop to select script and run it.</p>\n<p>Full scripts is as follows</p>\n<pre class=\'hljs\'><code class="language-JavaScript">app.preferences.rulerUnits = Units.PIXELS;\n<span class="hljs-keyword">if</span> (app.documents.length &gt; <span class="hljs-number">0</span>) {<span class="hljs-comment">//If there is file left open</span>\n  alert(<span class="hljs-string">"Please close all open documents before running this script."</span>);\n} <span class="hljs-keyword">else</span> {\n  <span class="hljs-comment">// The width and height for output. You may have to change this to make it dynamic.</span>\n  <span class="hljs-keyword">var</span> finalWidth = <span class="hljs-number">1600</span>;\n  <span class="hljs-keyword">var</span> finalHeight = <span class="hljs-number">1200</span>;\n  <span class="hljs-comment">// Use folder selection dialogs to get the location of the input files</span>\n  <span class="hljs-comment">// and where to save the new output files.</span>\n  <span class="hljs-keyword">var</span> sourceFolder = Folder.selectDialog(<span class="hljs-string">"Please choose the source image folder."</span>, Folder.myDocuments);\n  <span class="hljs-keyword">var</span> destFolder = Folder.selectDialog(<span class="hljs-string">"Please choose the target image folder"</span>, sourceFolder);\n  <span class="hljs-keyword">var</span> watermarkFile = File.openDialog(<span class="hljs-string">"Please choose a watermark image file."</span>, <span class="hljs-string">"*.png"</span>)\n  <span class="hljs-comment">// Consider only some images filetypes.</span>\n  <span class="hljs-keyword">var</span> files = sourceFolder.getFiles(<span class="hljs-regexp">/.+\\.(?:jpe?g|bmp|png)$/i</span>);\n  <span class="hljs-keyword">var</span> numOfFiles = files.length;\n  <span class="hljs-comment">//Iterate through folder</span>\n  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; files.length; i++){\n    <span class="hljs-keyword">var</span> f = files[i];\n    <span class="hljs-keyword">if</span> (f <span class="hljs-keyword">instanceof</span> Folder) {<span class="hljs-comment">//if file is folder, jump to next</span>\n      <span class="hljs-keyword">continue</span>;\n    }\n    <span class="hljs-keyword">var</span> docRef = app.open(f);\n    <span class="hljs-keyword">var</span> layerRef = docRef.activeLayer;\n    <span class="hljs-comment">//Resize image according to shape</span>\n    <span class="hljs-keyword">var</span> actualWidth = docRef.width;\n    <span class="hljs-keyword">var</span> actualHeight = docRef.height;\n    <span class="hljs-keyword">var</span> imgHeight = <span class="hljs-number">1000</span>;\n    <span class="hljs-keyword">var</span> imgWidth = actualWidth * imgHeight / actualHeight;\n    <span class="hljs-keyword">if</span> (imgWidth &gt; <span class="hljs-number">1333</span>) {\n      imgWidth = <span class="hljs-number">1333</span>;\n      imgHeight = actualHeight * imgWidth / actualWidth;\n    }\n    docRef.resizeImage(imgWidth,imgHeight);\n    <span class="hljs-comment">//Resize canvas, keep img in center</span>\n    docRef.resizeCanvas(finalWidth, finalHeight, AnchorPosition.MIDDLECENTER);\n    <span class="hljs-comment">//Add watermark</span>\n    app.bringToFront();\n    <span class="hljs-keyword">var</span> logoFile = watermarkFile; \n    placeWatermark(logoFile);\n    <span class="hljs-comment">//Merge visible layers, there is no mergeAllLayer function</span>\n    <span class="hljs-keyword">try</span>{\n        activeDocument.mergeVisibleLayers();\n    } <span class="hljs-keyword">catch</span>(e) {}\n    <span class="hljs-comment">//Get filename and extension to use it when saving.</span>\n    <span class="hljs-keyword">var</span> fileExtension = getFileExtension(f.name);\n    <span class="hljs-keyword">var</span> filename = getFilename(f.name);\n    <span class="hljs-comment">//Create new image and save as JPG</span>\n    <span class="hljs-keyword">var</span> outputFile = <span class="hljs-keyword">new</span> File(destFolder.absoluteURI + <span class="hljs-string">"/"</span> + filename + <span class="hljs-string">"."</span> + fileExtension);\n    saveAsJPG(docRef, outputFile, <span class="hljs-number">10</span>);\n    <span class="hljs-comment">//Close active document, this cannot be done w/o merging all layers</span>\n    docRef.close();\n  }\n  alert(numOfFiles + <span class="hljs-string">" files have been processed."</span>);\n}\n\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFileExtension</span>(<span class="hljs-params">fullFilename</span>) </span>{\n  <span class="hljs-keyword">return</span> fullFilename.split(<span class="hljs-string">\'.\'</span>).pop();\n}\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFilename</span>(<span class="hljs-params">fullFilename</span>) </span>{\n  <span class="hljs-keyword">var</span> finalDotPosition = fullFilename.lastIndexOf(<span class="hljs-string">"."</span>) ;\n  <span class="hljs-keyword">if</span> ( finalDotPosition &gt; <span class="hljs-number">-1</span> ) {\n    <span class="hljs-keyword">return</span> fullFilename.substr( <span class="hljs-number">0</span> , finalDotPosition );\n  }\n  <span class="hljs-keyword">return</span> fullFilename;\n}\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveAsJPG</span>(<span class="hljs-params">docRef, saveFile, jpegQuality</span>) </span>{\n  options = <span class="hljs-keyword">new</span> JPEGSaveOptions();\n  options.quality = jpegQuality;\n  docRef.saveAs(saveFile, options, <span class="hljs-literal">false</span>,Extension.LOWERCASE);\n}\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">placeWatermark</span>(<span class="hljs-params">Image</span>)</span>{  \n  <span class="hljs-keyword">if</span>(!documents.length) {<span class="hljs-comment">// if no image is open then return</span>\n    <span class="hljs-keyword">return</span>;\n  } \n  <span class="hljs-keyword">var</span> fileObj = <span class="hljs-keyword">new</span> File(Image);<span class="hljs-comment">// the passed file</span>\n  <span class="hljs-keyword">if</span>(!fileObj.exists){<span class="hljs-comment">// If watermark file does not exits tell user </span>\n    alert(fileObj.name  + <span class="hljs-string">" does not exist!"</span>);<span class="hljs-comment">// Alert User </span>\n    <span class="hljs-keyword">return</span>;\n  }  \n  <span class="hljs-keyword">try</span>{  \n    <span class="hljs-keyword">var</span> doc = app.activeDocument;<span class="hljs-comment">// set Doc object to active document</span>\n    app.displayDialogs = DialogModes.NO;<span class="hljs-comment">// Dialog off </span>\n    <span class="hljs-keyword">var</span> strtRulerUnits = app.preferences.rulerUnits;<span class="hljs-comment">// Save Users ruler units </span>\n    <span class="hljs-keyword">var</span> strtTypeUnits = app.preferences.typeUnits;<span class="hljs-comment">// Save Users Type units </span>\n    app.preferences.rulerUnits = Units.PIXELS;<span class="hljs-comment">// work with pixels </span>\n    app.preferences.typeUnits = TypeUnits.PIXELS;<span class="hljs-comment">// work with pixels </span>\n    <span class="hljs-keyword">var</span> layers = app.activeDocument.layers;<span class="hljs-comment">// get layers</span>\n    app.activeDocument.activeLayer = layers[<span class="hljs-number">0</span>];<span class="hljs-comment">// Target Top Layer</span>\n    placeFile(fileObj);<span class="hljs-comment">// Place in file the Watermark png file</span>\n  }\n  <span class="hljs-keyword">catch</span>(e) { alert(e + <span class="hljs-string">\': on line \'</span> + e.line); }<span class="hljs-comment">// inform user of error</span>\n  <span class="hljs-keyword">finally</span>{  \n    app.preferences.rulerUnits = strtRulerUnits;<span class="hljs-comment">// Restore user ruler units  </span>\n    app.preferences.typeUnits = strtTypeUnits;<span class="hljs-comment">// Restore user type units    </span>\n  };\n}\n<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">placeFile</span>(<span class="hljs-params">placeFile</span>) </span>{  \n  <span class="hljs-keyword">var</span> desc21 = <span class="hljs-keyword">new</span> ActionDescriptor();  \n  desc21.putPath( charIDToTypeID(<span class="hljs-string">\'null\'</span>), <span class="hljs-keyword">new</span> File(placeFile) );  \n  desc21.putEnumerated( charIDToTypeID(<span class="hljs-string">\'FTcs\'</span>), charIDToTypeID(<span class="hljs-string">\'QCSt\'</span>), charIDToTypeID(<span class="hljs-string">\'Qcsa\'</span>) );  \n  <span class="hljs-keyword">var</span> desc22 = <span class="hljs-keyword">new</span> ActionDescriptor();  \n  desc22.putUnitDouble( charIDToTypeID(<span class="hljs-string">\'Hrzn\'</span>), charIDToTypeID(<span class="hljs-string">\'#Pxl\'</span>), <span class="hljs-number">0.000000</span> );  \n  desc22.putUnitDouble( charIDToTypeID(<span class="hljs-string">\'Vrtc\'</span>), charIDToTypeID(<span class="hljs-string">\'#Pxl\'</span>), <span class="hljs-number">0.000000</span> );  \n  desc21.putObject( charIDToTypeID(<span class="hljs-string">\'Ofst\'</span>), charIDToTypeID(<span class="hljs-string">\'Ofst\'</span>), desc22 );  \n  executeAction( charIDToTypeID(<span class="hljs-string">\'Plc \'</span>), desc21, DialogModes.NO );  \n}\n</code></pre>\n<h1><a id="Experience_from_this_153"></a>Experience from this</h1>\n<p>I really like this saying(by myself) <em>&quot;JavaScript is always number one&quot;</em> now, so far I can finish most of the tech-related works with JavaScript, this alone is amazing.</p>\n<p>But it seems that there are not many learning materials about JavaScript for Photoshop online, I\'ll have to wait til next time I encounter a problem to learn more then.</p>\n<p>Thumb up for JavaScript here!</p>\n',prev:s,next:"editor-for-my-cms-of-my-nuxt-blog"},tags:l,date:p}],fetch:[],error:null,state:{lang:{val:"Chi",ui:o,title:"Change navigation to English"}},serverRendered:!0,routePath:"/blog/script-for-photoshop-bulk-resize-and-watermark-en"}}("script-for-photoshop-bulk-resize-and-watermark","post","JavaScript","Photoshop","script-for-photoshop-bulk-resize-and-watermark-en",Array(5),"English","2020-04-13")</script><script src="/_nuxt/5b0027e8e089eb910acf.js" defer></script><script src="/_nuxt/5501b08dff52e3b9135b.js" defer></script><script src="/_nuxt/0432c1a2dd8b48d52e80.js" defer></script><script src="/_nuxt/2cf4f1d92facee93c1c1.js" defer></script>
  </body>
</html>
